<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[OkHttp中添加https支持]]></title>
    <url>%2F2018%2F01%2F10%2FOkHttp%E4%B8%AD%E6%B7%BB%E5%8A%A0https%E6%94%AF%E6%8C%81%2F</url>
    <content type="text"><![CDATA[基础知识 感觉就是一堆有信誉的机构,说: 我们这些机构的公钥是可信的,我们下面的小弟当然也是可以信任的啦 然后大家就去当人家小弟,就是可信的了…. 当然这里面有的大佬不高兴,就自己搞一套证书,比如12306 Https中,值得注意的密钥有: 服务器端的公钥和私钥 客户端的随机密钥 值得注意的是一个HTTPS请求实际上就是两次HTTP传输. 1.客户端向服务器发起HTTPS请求，连接到服务器的443端口。 2.服务端收到请求,向客户端发送自己的公钥 3.客户端收到服务器公钥,开始验证证书的合法性,我们知道系统内置了一些证书,应该是叫顶级证书吧 我们的证书并不是啥大机构发的,肯定不在里面,那么就没法验证合法. ​ 合法 &gt; 继续 ​ 不合法 &gt; 此次Https请求终止 4.客户端验证公钥合格后(也就是给你发消息的服务器是正经服务器)，那么客户端会生成一个 随机密码,客户端会拿着这个随机密码和刚才收到的服务器密钥做非对称加密 &gt;&gt; 得到密文的密码 ——–以上第一次http请求结束了——– 5.客户端会发起HTTPS中的第二个HTTP请求,发送客户端密钥(密文)给服务器。 6.服务器收到密文，会用自己的私钥对其进行非对称解密,得到客户端刚才生成的客户端随机密码. 此时服务器使用客户端随机密码,对数据进行对称加密 7.把对称加密后的数据返回给客户端,客户端对称解密,OK 此次Https完美结束 ——–整个https请求结束了——– 其中 , 对称加密和非对称加密, 各司其职,共同完成整个请求. 对称加密: 最快速,最简单 非对称加密:速度慢,很安全,不需要把秘钥分发,客户端利用公钥加密的数据,只能是拥有秘钥的服务器解密 利用非对称加密的特性传递 客户端生成的随机密钥 ,达到只有服务器和客户端互相知道的密钥,从而使用密钥进行(高速简单的)对称加密数据. 第一部分:信任所有 这就是,我不管是谁传递的消息,不是你家服务器传递的消息,你也会信 Api.java (提供okhttp实例,并创建Retroit服务) 123456789101112131415161718192021222324OkHttpClient okHttpClient = new OkHttpClient.Builder() .hostnameVerifier(new HostnameVerifier() &#123; @Override public boolean verify(String hostname, SSLSession session) &#123; return true; &#125; &#125;) .sslSocketFactory(createSSLSocketFactory()) .build(); ...//这里是创建一个SSLSocketFactory,提供给上面的 .sslSocketFactory()private SSLSocketFactory createSSLSocketFactory() &#123; SSLSocketFactory ssfFactory = null; try &#123; SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;); sc.init(null, new TrustManager[]&#123;new TrustAllCerts()&#125;, new SecureRandom()); ssfFactory = sc.getSocketFactory(); &#125; catch (Exception e) &#123; &#125; return ssfFactory; &#125; 其中涉及到TrustAllCerts.java,可以看到只是实现X509TrustManager,所有方法都是默认实现 1234567891011121314151617/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/8 下午2:25 */public class TrustAllCerts implements X509TrustManager &#123; @Override public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException &#123;&#125; @Override public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException &#123;&#125; @Override public X509Certificate[] getAcceptedIssuers() &#123; return new X509Certificate[0]; &#125;&#125; 这里就以及可以了,信任所有的连接 第二部分:(强验证) 我只信任证书合法的服务器传递的数据. 查看Https的证书 在浏览器上看到这个,这个已经是我把证书添加为信任了,所以他是一个 安全 的标志 分析 这里是我查看当前网站证书的结构 最顶—是根证书,到期时间是2028年 最底—是我司证书,到期时间是2018.12.9日 这里我们可以发现,我们网站的证书是有时间限制的,那么就会有一个问题,到了2018.12.9这一天怎么办. 我也不知道会怎么样,应该是续签吧!那么万一这个证书变化了怎么办? 所以,我们应该把根证书置为信任. 下载保存 Mac的在 钥匙串访问 中 Windows 没法放图,在chrome上查看证书的时候应该就能保存. HttpsUtils.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/10 下午5:07 * 支持https的工具类 */public class HttpsUtils &#123; private static final String TAG = &quot;OkHttp&quot;; /** * 创建一个空白的KeyStore * @return KeyStore * @throws GeneralSecurityException */ private static KeyStore createEmptyKeyStore() throws GeneralSecurityException &#123; try &#123; KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType()); //此处密码随意,不会产生问题 keystore.load(null, &quot;password&quot;.toCharArray()); return keystore; &#125; catch (IOException e) &#123; return null; &#125; &#125; /** * TrustManager 生成 * @return * @throws GeneralSecurityException */ private static TrustManager[] generateTrustManager() throws GeneralSecurityException &#123; //创建一个X.509格式的CertificateFactory CertificateFactory certificateFactory = CertificateFactory.getInstance(&quot;X.509&quot;); Certificate ca; //证书工厂根据证书文件的流生成证书Certificate InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca); ca = certificateFactory.generateCertificate(assets); Log.e(TAG, &quot;trustManager: ca = &quot; + ((X509Certificate) ca).getSubjectDN() ); //创建KeyStore，用来存储信任证书 KeyStore keyStor = createEmptyKeyStore(); keyStor.setCertificateEntry(&quot;ca&quot;,ca); //创建一个默认类型的TrustManagerFactory String defaultAlgorithm = TrustManagerFactory.getDefaultAlgorithm(); TrustManagerFactory tmf = TrustManagerFactory.getInstance(defaultAlgorithm); //用keyStore实例初始化TrustManagerFactory,此时TrustManagerFactory会信任我们保存的证书 tmf.init(keyStor); //通过tmf获取TrustManager数组，TrustManager也会信任keyStor中的证书 return tmf.getTrustManagers(); &#125; /** * 提供一个一个SSLSocketFactory * @return SSLSocketFactory实例 */ public static SSLSocketFactory generateSSLSocketFactory() &#123; try &#123; SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;); sc.init(null, generateTrustManager(), new SecureRandom()); Log.e(TAG, &quot;generateSSLSocketFactory &quot;); return sc.getSocketFactory(); &#125; catch (GeneralSecurityException e) &#123; return null; &#125; &#125;&#125; 注释很清楚了. 关键: 1.拿到帧数的流 1InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca); 2.保存到keystore 12KeyStore keyStor = createEmptyKeyStore();keyStor.setCertificateEntry(&quot;ca&quot;,ca); 3.初始化并拿到TrustManager[] 12tmf.init(keyStor);tmf.getTrustManagers() 使用即可: 12345//这样就OkOkHttpClient okHttpClient = new OkHttpClient.Builder() .hostnameVerifier((hostname, session) -&gt; true) .sslSocketFactory(HttpsUtils.generateSSLSocketFactory()) .build(); 超好的两篇 http://blog.csdn.net/lmj623565791/article/details/48129405 http://blog.csdn.net/iispring/article/details/51615631]]></content>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WebView播放H5视屏没有画面,只有声音]]></title>
    <url>%2F2018%2F01%2F04%2FWebView%E6%92%AD%E6%94%BEH5%E8%A7%86%E5%B1%8F%E6%B2%A1%E6%9C%89%E7%94%BB%E9%9D%A2-%E5%8F%AA%E6%9C%89%E5%A3%B0%E9%9F%B3%2F</url>
    <content type="text"><![CDATA[描述:点击播放按钮后,只能听到声音,而画面是白的….一直白…想到应该是硬件加速的问题 1.确认硬件加速(非此因素) 在WebViewActivity.java中发现 1webView.setLayerType(View.LAYER_TYPE_HARDWARE, null); 2.确认AndroidManifest.xml(非此因素) application节点下并没有发现 1android:hardwareAccelerated=&quot;true&quot; 在WebViewActivity中,也无该配置 尝试: WebViewActivity.java中,注释 1#webView.setLayerType(View.LAYER_TYPE_HARDWARE, null); 在AndroidManifest.xml节点下加入android:hardwareAccelerated=&quot;true&quot; 结果……没用 3.检查activity_web_view.xml 1234567&lt;WebView android:id="@+id/webView" android:layout_width="match_parent" android:layout_height="match_parent" android:scrollbars="none" android:visibility="@&#123;showError?View.GONE:View.VISIBLE&#125;" /&gt; 没问题. BUT…. 12345678910111213141516171819202122232425262728&lt;LinearLayout android:layerType="software" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical"&gt; &lt;include layout="@layout/layout_toolbar" /&gt; &lt;ProgressBar android:id="@+id/web_load_progress" style="?android:attr/progressBarStyleHorizontal" android:layout_width="match_parent" android:layout_height="2dp" android:indeterminateOnly="false" android:max="100" android:progress="@&#123;progress&#125;" android:progressDrawable="@drawable/progress_bar_states" android:visibility="gone" /&gt; &lt;WebView android:id="@+id/webView" android:layout_width="match_parent" android:layout_height="match_parent" android:scrollbars="none" android:visibility="@&#123;showError?View.GONE:View.VISIBLE&#125;" /&gt;&lt;/LinearLayout&gt; ####父布局竟然android:layerType=&quot;software&quot; 解决,删掉该属性即可]]></content>
      <categories>
        <category>Bug记录</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Bug</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Room中List使用详解]]></title>
    <url>%2F2018%2F01%2F03%2FRoom%E4%B8%ADList-%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[手摸手教你在Room中使用List. 实际项目有很多这样的结构: 12345678910111213141516171819&#123; &quot;id&quot;: &quot;001&quot;, &quot;name&quot;: &quot;王诛魔&quot;, &quot;age&quot;: 2018, &quot;books&quot;: [ &#123; &quot;bookId&quot;: 10081, &quot;userId&quot;: 1, &quot;book&quot;: &quot;断罪小学&quot;, &quot;desc&quot;: &quot;漫画讲述了李杀神、王诛魔和刘斩仙三位少年，为了十万小学生的未来、为了改变被诅咒的命运，相聚在狼牙区飞虎路私立断罪小学，誓死打败四年级的魔神赵日天的故事。&quot; &#125;, &#123; &quot;bookId&quot;: 10088, &quot;userId&quot;: 1, &quot;book&quot;: &quot;狂霸天下之断罪学园&quot;, &quot;desc&quot;: &quot;《狂霸天下之断罪学园》，后来因为名字太长，而且“学园”和“学院”容易混淆的原因而改名。&quot; &#125; ]&#125; 也就是,类似books这样的,List作为一个元素存在. 下面就以上面的结构为例,做一个简单的演示,按照最简答的方法实现. 1.添加依赖 https://developer.android.google.cn/topic/libraries/architecture/adding-components.html 值得注意的是,如果你在kotlin中使用 12345678910apply plugin: 'kotlin-kapt'...dependencies&#123; ... //这个无法生成代码,要用下面的那一条,不要疏忽忘掉了. //annotationProcessor "android.arch.persistence.room:compiler:1.0.0" kapt "android.arch.persistence.room:compiler:1.0.0"&#125; 一定记得使用kapt,要不然就会遇到这个BUG. 2.创建表 User.java表 1234567891011/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/3 下午1:31 */@Entity(tableName = "users")public class User &#123; @PrimaryKey public int id; public String name; public int age;&#125; @Entity 中指定了表名 @PrimaryKey 主键 这张表users 用于保存用户数据 Book.java表 123456789101112131415161718/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/3 下午1:30 */@Entity(foreignKeys = &#123; @ForeignKey( entity = User.class, parentColumns =&#123;"id"&#125;, childColumns = &#123;"userId"&#125;)&#125;,tableName = "books")public class Book &#123; @PrimaryKey public int bookId; public int userId;//同User.java中的id public String book; public String desc;&#125; @Entity 中 foreignKeys = {} 中外键,可以是多个,这里只关联了User表 tableName = “books” 指定了表名 @PrimaryKey 该表主键 ​ ​ UserAndBook.java表 —-UserAndBook只是辅助,不作为一张表存在. 12345678910111213/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/3 下午1:43 */public class UserAndBook &#123; @Embedded //请看之前的文章,这是指把User中所有元素带入到这里作为元素存在 public User userEntity; //@Relation @Relation(parentColumn = "id",entityColumn = "userId",entity = Book.class) public List&lt;Book&gt; books;&#125; @Embedded 请看另一篇,有解释 ​ @Relation 点这里去看官方文档 A convenience annotation which can be used in a Pojo to automatically fetch relation entities. When the Pojo is returned from a query, all of its relations are also fetched by Room. 个人以为就是一注解,指明关系,可以把实体关联起来,然后自动组装起来. ​ 并且在文档中还展示了一种高端的功能,用上面做例 1234//@Relation @Relation(parentColumn = "id",entityColumn = "userId", entity = Book.class ,projection = &#123;"book"&#125;) public List&lt;String&gt; bookNames; 解释一下,projection指定了要取出的值,当前指明要在 books表中寻找符合条件parentColumn = “id”,entityColumn = “userId” 的项,找到之后会拿到book这个值并返回. 3.Dao实现 12345678910111213141516171819202122/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2018/1/3 下午4:20 */@Daopublic abstract class UserAndBookDao &#123; @Insert(onConflict = OnConflictStrategy.REPLACE) public abstract void insert(User user); @Insert(onConflict = OnConflictStrategy.REPLACE) public abstract void insert(List&lt;Book&gt; books); @Transaction public void insert(UserAndBook userAndBook)&#123; insert(userAndBook.userEntity); insert(userAndBook.books); &#125; @Query("SELECT * FROM users") public abstract List&lt;UserAndBook&gt; getAll();&#125; insert(User user); ,insert(List&lt;Book&gt; books); 两个方法,也可以私有化,只对外提供insert(UserAndBook userAndBook) 最近换公司项目的数据库,用sql,真的有意思,可以很方便的实现很多功能 4.建立数据库 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778/** * If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/24 上午10:13 * 数据库 */@Database(entities = &#123;Book.class, User.class&#125;, version = 1, exportSchema = false)public abstract class AppDB extends RoomDatabase &#123; private static final String TAG = "AppDB"; /** * 数据库实例 */ private static AppDB sInstance; private static String DATABASE_NAME = "developer.db"; private ObservableBoolean mIsDatabaseCreated = new ObservableBoolean(false); public abstract UserAndBookDao userbook(); /** * 单例 * @param context * @return */ public static AppDB getInstance(Context context) &#123; if (sInstance == null) &#123; synchronized (AppDB.class) &#123; if (sInstance == null) &#123; sInstance = buildDatabase(context); sInstance.updateDatabaseCreated(context); &#125; &#125; &#125; return sInstance; &#125; /** * Build the database. * creates a new instance of the database. */ private static AppDB buildDatabase(Context appContext) &#123; AppDB appDB = Room.databaseBuilder(appContext, AppDB.class, DATABASE_NAME) .addCallback(new Callback() &#123; @Override public void onCreate(@NonNull SupportSQLiteDatabase db) &#123; super.onCreate(db); AppDB database = AppDB.getInstance(appContext); database.setDatabaseCreated(); &#125; @Override public void onOpen(@NonNull SupportSQLiteDatabase db) &#123; super.onOpen(db); Log.e(TAG, "onOpen: " + db.getPath()); &#125; &#125;).build(); return appDB; &#125; /** * Check whether the database already exists and expose it via */ private void updateDatabaseCreated(final Context context) &#123; if (context.getDatabasePath(DATABASE_NAME).exists()) &#123; setDatabaseCreated(); &#125; &#125; private void setDatabaseCreated() &#123; mIsDatabaseCreated.set(true); &#125; public ObservableBoolean getDatabaseCreated() &#123; return mIsDatabaseCreated; &#125;&#125; 为了方便使用,在Application中添加了 123public static AppDB getDatabase() &#123; return AppDB.getInstance(context);&#125; 5.使用 这里的使用方式,不建议使用,太粗暴了. 可以学学Demo,Google出的googlesamples/android-architecture-components 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263class RoomActivity : BindingActivity&lt;ActivityRoomBinding, RoomViewModel&gt;() &#123; val gson = Gson() override fun getBundle(extras: Bundle) &#123; &#125; override fun layoutID(): Int = R.layout.activity_room override fun initViews(savedInstanceState: Bundle?) &#123; //点击事件 ADD按钮,添加数据到数据库 mBindingView.button.setOnClickListener(&#123; val userBook = UserAndBook() val jsonStr = FileUtils.getJson(this, "data.txt") val objectJson = JsonParser().parse(jsonStr).asJsonObject //获取用户 val user = objectJson.get("user") userBook.userEntity = gson.fromJson&lt;User&gt;(user, User::class.java) //保存用户 Observable .empty&lt;Any&gt;() .observeOn(Schedulers.io()) .subscribe(object : EmptyObserver&lt;Any?&gt;() &#123; override fun onComplete() &#123; App.getDatabase().userbook().insert(userBook.userEntity) &#125; &#125;) //获取书籍 val books = objectJson.get("books") userBook.books = gson.fromJson&lt;ArrayList&lt;Book&gt;&gt; (books, object : TypeToken&lt;List&lt;Book&gt;&gt;() &#123;&#125;.type) //保存书籍 Observable .empty&lt;Any&gt;() .observeOn(Schedulers.io()) .subscribe(object : EmptyObserver&lt;Any?&gt;() &#123; override fun onComplete() &#123; App.getDatabase().userbook().insert(userBook.books) &#125; &#125;) &#125;) //点击事件,按钮QUERY 查询数据 mBindingView.button2.setOnClickListener &#123; Flowable.create(FlowableOnSubscribe&lt;List&lt;UserAndBook&gt;&gt; &#123; e -&gt; val userBook = App.getDatabase().userbook().all e.onNext(userBook) e.onComplete() &#125;, BackpressureStrategy.DROP) .compose(DatabaseTransformer()) .subscribe(object : DatabaseSubscriber&lt;List&lt;UserAndBook&gt;&gt;() &#123; override fun onNext(userAndBooks: List&lt;UserAndBook&gt;) &#123; mBindingView.data = userAndBooks[0] &#125; &#125;) &#125; &#125;&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;layout xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;data&gt; &lt;import type="com.wangzhumo.app.data.UserAndBook"/&gt; &lt;import type="com.wangzhumo.app.data.User"/&gt; &lt;import type="com.wangzhumo.app.data.Book"/&gt; &lt;variable name="data" type="com.wangzhumo.app.data.UserAndBook"/&gt; &lt;/data&gt; &lt;RelativeLayout android:layout_width="match_parent" android:layout_height="match_parent"&gt; &lt;Button android:id="@+id/button" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentLeft="true" android:layout_alignParentStart="true" android:layout_alignParentTop="true" android:layout_marginLeft="57dp" android:layout_marginStart="57dp" android:layout_marginTop="125dp" android:text="Add" /&gt; &lt;Button android:id="@+id/button2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignBaseline="@+id/button" android:layout_alignBottom="@+id/button" android:layout_alignParentEnd="true" android:layout_alignParentRight="true" android:layout_marginEnd="56dp" android:layout_marginRight="56dp" android:text="Query" /&gt; &lt;RelativeLayout android:layout_width="match_parent" android:layout_height="match_parent" android:layout_alignParentLeft="true" android:layout_alignParentStart="true" android:layout_below="@+id/button" android:layout_marginTop="68dp"&gt; &lt;TextView android:id="@+id/textView" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentLeft="true" android:layout_alignParentStart="true" android:layout_alignParentTop="true" android:layout_marginLeft="36dp" android:layout_marginStart="36dp" android:layout_marginTop="32dp" android:text="@&#123;data.userEntity.name&#125;" /&gt; &lt;TextView android:id="@+id/textView2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignLeft="@+id/textView" android:layout_alignStart="@+id/textView" android:layout_below="@+id/textView" android:layout_marginTop="41dp" android:text="@&#123;data.books.get(0).book&#125;" /&gt; &lt;TextView android:id="@+id/textView3" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignLeft="@+id/textView2" android:layout_alignStart="@+id/textView2" android:layout_centerVertical="true" android:text="@&#123;data.books.get(0).desc&#125;" /&gt; &lt;/RelativeLayout&gt; &lt;/RelativeLayout&gt;&lt;/layout&gt; ​ ​]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Room</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android字体不跟随系统变化]]></title>
    <url>%2F2017%2F12%2F28%2FAndroid%E5%AD%97%E4%BD%93%E4%B8%8D%E8%B7%9F%E9%9A%8F%E7%B3%BB%E7%BB%9F%E5%8F%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[已知的方法有两种: 第一种 不使用sp 而使用 dp 第二种 在Application中加入 1234567891011121314151617@Overridepublic void onConfigurationChanged(Configuration newConfig) &#123; if (newConfig.fontScale != 1) getResources(); super.onConfigurationChanged(newConfig);&#125;@Overridepublic Resources getResources() &#123; Resources res = super.getResources(); if (res.getConfiguration().fontScale != 1) &#123; Configuration newConfig = new Configuration(); newConfig.setToDefaults(); res.updateConfiguration(newConfig, res.getDisplayMetrics()); &#125; return res;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apk Install 的各种问题]]></title>
    <url>%2F2017%2F12%2F28%2FApk-Install-%E7%9A%84%E5%90%84%E7%A7%8D%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[[INSTALL_FAILED_TEST_ONLY: installPackageLI] 方法1：AndroidManifest.xml 加入android:testOnly=”false”。 方法2：adb install -t *.apk]]></content>
      <categories>
        <category>Bug记录</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Bug</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Studio报错Error Running app: cannot debug application]]></title>
    <url>%2F2017%2F12%2F26%2FAndroid-Studio%E6%8A%A5%E9%94%99Error-Running-app-cannot-debug-application%2F</url>
    <content type="text"><![CDATA[Android Studio报错Error Running app: cannot debug application 这里有一位仁兄帮忙翻译了. http://blog.csdn.net/yishichangan1/article/details/77451486 1234567891011Cannot debug application xx.xxx.xxx.app on device lge_nexus_5x(此处表示你的手机型号).你的xxxapp不能在型号为Nexus 5x的LGE手机上调试。This application does not have the debuggable attribute enabled in its manifest.这个项目在清单文件（AndroidManifest.xml）中没有设置可以调试的参数。If you have manually set it in the manifest, then remove it and let the IDE automatically assign it.如果你已经手动在清单文件种设置了这个属性，请remove掉，让IDE自动生成。If you are using Gradle, make sure that your current variant is debuggable.如果你使用Gradle，确认你现在的变体是可调试的。 ####我就知道是我自己选了release….果然]]></content>
      <categories>
        <category>Bug记录</category>
      </categories>
      <tags>
        <tag>Android Studio</tag>
        <tag>Android</tag>
        <tag>Bug</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Centos 创建用户并实现免密码登录]]></title>
    <url>%2F2017%2F12%2F25%2FCentos%20%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%2F</url>
    <content type="text"><![CDATA[比如,创建一个名为wzm的账号 ####创建账号 1.创建 1234[root@localhost ~]# adduser wzm[root@localhost ~]# passwd wzm#此时,输入两次密码即可 2.赋予sudo 1234567891011121314#找到sudoers[root@localhost ~]# whereis sudoers#修改sudoers的读写权限[root@localhost ~]# chmod -v u+w /etc/sudoers#加入新用户## Allow root to run any commands anywher root ALL=(ALL) ALL linuxidc ALL=(ALL) ALL #这个是新增的用户#把sudoers权限还给他[root@localhost ~]# chmod -v u-w /etc/sudoers 3.尽情享用吧 ####ssh免密码登录 1.修改配置文件sudo vim /etc/ssh/sshd_config 2.重启ssh服务service sshd restart 3.生成密钥1234ssh-keygen -t rsa 默认在 ~/.ssh目录生成两个文件： id_rsa ：私钥 id_rsa.pub ：公钥 4.导入本机cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys 5.下载到客户端并设置12345678910scp [-r] 用户名@ip:文件路径 本地路径#下载文件scp [-r] 本地文件 用户名@ip:上传路径 eg:~/.ssh ⌚ 16:27:33$ scp id_rsa.pub root@45.XX.XX.XX:/home/id_rsa.pub 6.改权限如果希望ssh公钥生效需满足至少下面两个条件： 1) .ssh目录的权限必须是7002) .ssh/authorized_keys文件权限必须是600 eg: 1234~ ⌚ 16:33:21$ ssh wzm@45.XX.XX.XXLast login: Mon Dec 25 16:21:11 2017 from 118.102.XXX.XXX[wzm@wangzhumo ~]$]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Server</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android项目中使用RxBus进行通讯]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8RxBus%E8%BF%9B%E8%A1%8C%E9%80%9A%E8%AE%AF%2F</url>
    <content type="text"><![CDATA[加入JakeWharton大神的RxRelay JakeWharton/RxRelay1compile &apos;com.jakewharton.rxrelay2:rxrelay:2.0.0&apos; RxBus.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/11/30 下午6:09 * */public class RxBus &#123; private Relay&lt;Object&gt; mBus = null; private static volatile RxBus mDefaultInstance; public RxBus() &#123; mBus = PublishRelay.create().toSerialized(); &#125; public static RxBus getDefault() &#123; if (mDefaultInstance == null) &#123; synchronized (RxBus.class) &#123; if (mDefaultInstance == null) &#123; mDefaultInstance = new RxBus(); &#125; &#125; &#125; return mDefaultInstance; &#125; /** * 发送事件 */ public void post(Object event) &#123; mBus.accept(event); &#125; /** * 根据传递的 eventType 类型返回特定类型(eventType)的 被观察者 */ public &lt;T&gt; Observable&lt;T&gt; toObservable(Class&lt;T&gt; eventType) &#123; return mBus.ofType(eventType); &#125; /** * 判断是否有订阅者 */ public boolean hasObservers() &#123; return mBus.hasObservers(); &#125; /** * 取消订阅 * @param disposable */ public void unregister(Disposable disposable) &#123; if (disposable != null &amp;&amp; !disposable.isDisposed()) &#123; disposable.dispose(); &#125; &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext) &#123; return toObservable(eventType).observeOn(scheduler).subscribe(onNext); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete, Consumer onSubscribe) &#123; return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete, onSubscribe); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete) &#123; return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError) &#123; return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext) &#123; return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete, Consumer onSubscribe) &#123; return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete, onSubscribe); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete) &#123; return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete); &#125; public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError) &#123; return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError); &#125;&#125; 还有一个通用的Event.java依据自己的需要制定即可 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/19 下午5:38 * * 发送事件包装类 */public class Event&lt;T&gt; &#123; public static final int EVENT_CLOSE_ALL_ACTIVITY = 10001; /** * reserved data */ private T data; /** * this code distinguish between different events */ private int eventCode = -1; public Event(int eventCode) &#123; this(eventCode, null); &#125; public Event(int eventCode, T data) &#123; this.eventCode = eventCode; this.data = data; &#125; /** * get event code * * @return */ public int getCode() &#123; return this.eventCode; &#125; /** * get event reserved data * * @return */ public T getData() &#123; return this.data; &#125;&#125; RxBus的使用 注册 最好是再基类中,加上. 1234567891011121314151617181920if (useEventBus()) &#123; //注册eventbus Disposable disposable = RxBus.getDefault() .register(Event.class, new Consumer&lt;Event&gt;() &#123; @Override public void accept(Event event) &#123; int eventCode = event.getCode(); Log.e(&quot;RxBus&quot;, event.toString()); switch (eventCode) &#123; case Event.EVENT_CLOSE_ALL_ACTIVITY: break; default: onEvent(event); break; &#125; &#125; &#125;); addDispose(disposable);&#125; 其中: useEventBus()由子类实现,是否开启RxBus,避免浪费 addDispose(disposable);addDispose 是基类的方法 12345678910/** * RxJava 添加订阅 */protected void addDispose(Disposable disposable) &#123; if (mDisposables == null) &#123; mDisposables = new CompositeDisposable(); &#125; //将所有disposable放入,集中处理 mDisposables.add(disposable);&#125; 统一管理,销毁时一起销毁,避免爆内存 onEvent(event);是一个空方法,如果子类重写就把事件交给子类处理 发送 123RxBus.getDefault().post(new Event(100,&quot;message&quot;))//code最好在Event.java中统一定义,方便管理 处理 12345override fun onEvent(event: Event&lt;*&gt;?) &#123; super.onEvent(event) &#125; 这一部分,其实在 注册 中已经完成,只要子类自己重写方法,就能取到数据]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Rxjava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android开发中常用的Adb命令]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid%E5%BC%80%E5%8F%91%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84Adb%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[在做这些之前,先配置好adb环境变量,以我的配置为例 12345678910111213$ vim ~/.bash_profileexport ANDROID_HOME=/Users/phyooos/Library/Android/sdk...export PATH=&#123;省略&#125;:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools$ source ~/.bas$ adbAndroid Debug Bridge version 1.0.39Version 0.0.1-4500957Installed as /Users/phyooos/Library/Android/sdk/platform-tools/adb... 补充 adb shell pm list packages 当前手机安装的所有app包名adb shell pm list packages | grep ‘google’ 在所有包名中查找带’google’的 连接设备打开开发者 -&gt; 打开调试 -&gt; 允许调试 通过usb连接 通过wifi连接 保证Android设备与电脑在局域网中,网段好像也要一致 eg: 192.168.2.98 , 192.168.2.111 123~ ⌚ 9:44:55$ adb connect 192.168.6.51unable to connect to 192.168.6.51:5555: Connection refused 此时是连接不上的,要先tcpip 5555,如下: 12345#使用Tcp并监听端口5555adb tcpip 5555#连接设备adb connect 192.168.6.51 如果你想用usb调试 12#使用usb调试 adb usb PS:有的设备直接adb connect 即可,所以不妨先试试 ​ 查看设备 查看所有连接的设备 1234$ adb devicesList of devices attached3080b82d device860BCML228J8 device 指定设备(adb 命令必须指定一个设备使用) 123456abd -s 编号 命令比如我要连接3080b82d device 这个设备,安装一个apkeg:$ adb -s 3080b82d install Test.apkSuccess 安装,卸载apk 安装12$ adb -s 3080b82d install Users/phyooos/develop/Test.apkSuccess install 跟上apk的path即可 install 可以搭配几个参数使用,比较常用的是 install -r 替换掉原来的apk.(被称为强制安装) 至于其他的参数去google官网看吧 install -t 可以安装测试包 卸载 123adb uninstall [软件包名]adb uninstall -k [软件包名] -k 参数,卸载软件但是保留配置和缓存文件. 包名使用文章开始的命令查找即可(当前有两个手机,还要指定设备)12345$ adb -s 3080b82d shell pm list packages | grep 'miui'package:com.miui.screenrecorderpackage:com.miui.contentextensionpackage:com.miui.powerkeeper... 拉取,推送文件 发送文件到Android设备 adb push [本地路径] [远程路径] 从Android设备中下载文件 adb pull [远程路径] [本地路径] 截图录屏 截图adb shell screencap [path] 12adb shell screencap /sdcard/screen.png#截图并保存到/sdcard/screen.png 录屏adb shell screenrecord [path] 12adb shell screenrecord /sdcard/demo.mp4#录屏 注意: 按Ctrl-C 结束录制 12345678910adb shell screenrecord --size &lt;WIDTHxHEIGHT&gt;adb shell screenrecord --bit-rate &lt;RATE&gt;adb shell screenrecord --bit-rate 5000000 /sdcard/demo.mp4adb shell screenrecord --time-limit &lt;TIME&gt;adb shell screenrecord --rotateadb shell screenrecord --verbose ​ Package 查看系统内app信息 adb shell pm list packages 查看当前所有包 adb shell pm list packages 123456$ adb shell pm list packagespackage:com.flyme.roamingpaypackage:com.android.cts.priv.ctsshimpackage:com.meizu.ppspackage:com.meizu.net.pedometerpackage:com.android.providers.telephony 系统应用 adb shell pm list packages -s 123456$ adb shell pm list packages -spackage:com.miui.screenrecorderpackage:com.android.cts.priv.ctsshimpackage:com.qualcomm.qti.auth.sampleextauthservicepackage:com.qualcomm.qti.perfdump... 普通外来应用 adb shell pm list packages -3 123456$ adb shell pm list packages -3package:com.google.android.youtubepackage:com.hpbr.bosszhipinpackage:de.blinkt.openvpnpackage:org.iggymedia.periodtrackerpackage:com.daimajia.gold 其他参数 1234567891011121314#See their associated file.adb shell pm list packages -f #Filter to only show disabled packages.adb shell pm list packages -d #Filter to only show enabled packages.adb shell pm list packages -e #See the installer for the packages.adb shell pm list packages -i #Also include uninstalled packages.adb shell pm list packages -u 通过包名查找app位置 adb shell pm path [packagename] 12$ adb shell pm path com.miui.screenrecorderpackage:/system/app/MiuiScreenRecorder/MiuiScreenRecorder.apk 清除缓存adb shell pm clear [packageName] 清除了该app的 data cache 12$ adb shell pm clear com.yhcs.carmartSuccess ​ shell我们知道android其实精简了linux的命令,有一大部分linux命令没法用的 12345678910$ adb shell#即可进入如果要root权限,国内手机好像不一致,我是用过的为$ adb root$ adb shell此时权限就是root进入shell后,就可以为所欲为,一般和linux一致 不过这些,还是管用的 1ls , cd , rm , mkdir , touch , pwd ,cp , mv ,netstat , ping, ip 举一个例子,我想查看当前wifi的ip是多少. 12345678$ adb shellsagit:/ $ ip -f inet addr show wlan023: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 3000 inet 192.168.6.51/23 brd 192.168.7.255 scope global wlan0 valid_lft forever preferred_lft foreversagit:/ $#ip inet 192.168.6.51 这个就是 Logcatadb logcat [option] [filter] 查看log adb logcat 通过 control + c 退出 ​ 查看Debug的log adb logcat *:D Logcat,还是Android studio 看起来方便,所以没有继续去看,也就不说了 dumpsys这是一个很强大的命令 电量 adb shell dumpsys battery ​ 服务列表 adb shell dumpsys 下面的命令 | more 是为了显示所有的数据 1234567891011$ adb shell dumpsys | moreCurrently running services: DockObserver MiuiBackup MiuiInit SurfaceFlinger accessibility account activity alarm ... 这个Currently running services 所有的项目,都可以详细查询 查询单个service adb shell dumpsys [service name] 搞几个例子看看: 屏幕分辨率adb shell dumpsys window displays 123456$ adb shell dumpsys window displaysWINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays) Display: mDisplayId=0 init=1080x1920 480dpi cur=1080x1920 app=1080x1920 rng=1080x1020-1920x1860 deferred=false mLayoutNeeded=false 其中: init=1080x1920 分辨率 480dpi dpi值 ​ activity信息adb shell dumpsys activity 比如我想看看我activity的信息adb shell dumpsys activity | grep &#39;com.yhcs.carmart&#39; 1234567891011121314151617$ adb shell dumpsys activity | grep &quot;com.yhcs.carmart&quot; * com.yhcs.carmart: 2 items #0: PendingIntentRecord&#123;c526be3 com.yhcs.carmart startService&#125; #1: PendingIntentRecord&#123;8949e0 com.yhcs.carmart broadcastIntent&#125; -&gt; 8161:com.yhcs.carmart/u0a460 s1/1 u0/0 +44s372ms -&gt; 8556:com.yhcs.carmart:channel/u0a460 s1/1 u0/0 +33s684ms ... * Recent #0: TaskRecord&#123;6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1&#125; packageName=com.yhcs.carmart processName=com.yhcs.carmart launchedFromUid=10460 launchedFromPackage=com.yhcs.carmart userId=0 app=ProcessRecord&#123;3c52934 8161:com.yhcs.carmart/u0a460&#125; Intent &#123; cmp=com.yhcs.carmart/.ui.main.MainActivity &#125; frontOfTask=true task=TaskRecord&#123;6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1&#125; taskAffinity=com.yhcs.carmart realActivity=com.yhcs.carmart/.ui.main.MainActivity 现在指定查看这个activity 1234567891011121314$ adb shell dumpsys activity com.yhcs.carmart/.ui.main.MainActivityTASK com.yhcs.carmart id=14799 userId=0 ACTIVITY com.yhcs.carmart/.ui.main.MainActivity a99200b pid=8161 Local Activity 90efa41 State: mResumed=false mStopped=true mFinished=false mChangingConfigurations=false mCurrentConfig=&#123;1.0 460mcc11mnc [zh_CN] ldltr sw360dp w360dp h620dp 480dpi nrml long port finger -keyb/v/h -nav/h appBounds=Rect(0, 0 - 1080, 1920) s.12 themeChanged=0 themeChangedFlags=0&#125; ...View Hierarchy: DecorView@ce71c9e[MainActivity] android.widget.LinearLayout&#123;6106377 V.E...... ......ID 0,0-1080,1920&#125; ...Active Fragments ... 里面有很多信息 ​]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx安装及其简单配置]]></title>
    <url>%2F2017%2F12%2F25%2FNginx%E5%AE%89%E8%A3%85%E5%8F%8A%E5%85%B6%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[环境: centos7 1.下载安装 下载nginx-1.12.0,官网sudo wget http://nginx.org/download/nginx-1.12.0.tar.gz 解压sudo tar -zxvf nginx-1.12.0.tar.gz 其他的库,nginx依赖的库 安装gccyum -y install gcc 安装pcreyum -y install pcre pcre-devel 安装zlibyum -y install zlib zlib-devel 安装opensslyum -y install openssl openssl-devel 安装 12345sudo ./configure sudo make sudo make install 默认位置 /usr/local/nginx 如果安装过程中出现文件目录权限问题,百度即可解决. 2.系统中配置 1.在系统服务目录里创建nginx.service文件 1vim /lib/systemd/system/nginx.service 12345678910111213[Unit]Description=nginxAfter=network.target [Service]Type=forkingExecStart=/usr/local/nginx/sbin/nginxExecReload=/usr/local/nginx/sbin/nginx -s reloadExecStop=/usr/local/nginx/sbin/nginx -s quitPrivateTmp=true [Install]WantedBy=multi-user.target 2.设置开机启动 systemctl enable nginx.service 3.其他命令 启动nginx服务systemctl start nginx.service 设置开机自启动systemctl enable nginx.service 停止开机自启动systemctl disable nginx.service 查看服务当前状态systemctl status nginx.service 重新启动服务systemctl restart nginx.service 查看所有已启动的服务 systemctl list-units --type=service 3.nginx.conf的配置 12345678910111213[root@wangzhumo hooks]# cd /usr/local/nginx/[root@wangzhumo nginx]# lltotal 96drwx------ 2 root root 4096 Dec 24 20:57 client_body_tempdrwxr-xr-x 3 root root 4096 Dec 24 23:24 confdrwx------ 2 root root 4096 Dec 24 20:57 fastcgi_tempdrwxr-xr-x 2 root root 4096 Dec 23 10:38 htmldrwxr-xr-x 2 root root 4096 Dec 24 22:43 logs-rw-r--r-- 1 root root 53861 Dec 25 13:37 ondrwx------ 2 root root 4096 Dec 24 20:57 proxy_tempdrwxr-xr-x 2 root root 4096 Dec 23 10:38 sbindrwx------ 2 root root 4096 Dec 24 20:57 scgi_tempdrwx------ 2 root root 4096 Dec 24 20:57 uwsgi_temp 其中/conf存放配置文件/conf/nginx.confvim /conf/nginx.conf 什么都不要动,在nginx.conf第一条server配置下面写入:include vhost/*.conf; 123456789101112131415161718&#125;#此处是第一条可用的server的结束 #加入这句,其实是把其他地方配置的配置文件加载到里面来 #主要是为了方便管理,修改 include vhost/*.conf; # another virtual host using mix of IP-, name-, and port-based configuration # #server &#123; # listen 8000; # listen somename:8080; # server_name somename alias another.alias; # location / &#123; # root html; # index index.html index.htm; # &#125; #&#125; 3.1 /vhost/*.conf的配置 当前目录到cd /usr/local/nginx/conf 创建目录vhostmkdir /usr/local/nginx/conf/vhost 创建.conf文件(我只用到hexo的配置,所以只有一个配置文件)vim /usr/local/nginx/conf/vhost/hexo.conf 12345678910111213141516171819202122232425262728server&#123; listen 80; #listen [::]:80; server_name www.phyooos.top phyooos.top; index index.html index.htm index.php default.html default.htm default.php; #web root path root /home/wzm/hexo; #error_page 404 /404.html; location ~ .*\.(ico|gif|jpg|jpeg|png|bmp|swf)$ &#123; access_log on; expires 1d; &#125; location ~ .*\.(js|css|txt|xml)?$ &#123; access_log on; expires 12h; &#125; location / &#123; try_files $uri $uri/ =404; &#125; access_log /usr/local/nginx/logs/hexo.log combined;&#125; 4.重启systemctl reload nginx 在外面访问即可]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Server</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Room数据库使用指北List的问题]]></title>
    <url>%2F2017%2F12%2F25%2FRoom%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8C%97List%3C%3E%E7%9A%84%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[Room依赖 12implementation &quot;android.arch.persistence.room:runtime:1.0.0&quot;annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot; 查找 查找表中所有数据 123456/** * 查找user * @return */ @Query(&quot;SELECT * FROM banners&quot;) List&lt;BannerModel&gt; findBanners(); 按条件查找 1234567/** * filters * @return * @param typeSort */@Query(&quot;SELECT * FROM filters WHERE type != :typeSort&quot;)List&lt;FilterItemModel&gt; findFilters(String typeSort); 限制条数的条件查找 123456/** * 获取排序 * @return */@Query(&quot;SELECT * FROM filters WHERE type = :name LIMIT 0,1&quot;)FilterItemModel findSort(String name); 现在获取的是第一条数据 //文档中的例子 12345@Daopublic interface MyDao &#123; @Query(&quot;SELECT first_name, last_name FROM user WHERE region IN (:regions)&quot;) public List&lt;NameTuple&gt; loadUsersFromRegions(List&lt;String&gt; regions);&#125; 在user表中查找满足集合List regions中条件的元素 获取总行数 123456/** * 获取数据库表中总条数 * @return */@Query(&quot;SELECT count(*) FROM search_history&quot;)long findHistoryCount(); 获取某一列的和 123456/** * 求和 * @return */@Query(&quot;SELECT sum(count) FROM status_stock&quot;)long findStatusStockCount(); 按照降序排列(ASC升序 DESC降序) 123456/** * 查找user * @return */@Query(&quot;SELECT * FROM search_history ORDER BY time DESC&quot;)List&lt;SearchHistoryModel&gt; findSearchHistory(); 文档中的例子: 123456789101112131415161718192021@Daopublic interface MyDao &#123; //正常的查询 @Query(&quot;SELECT * FROM user WHERE age != :minAge&quot;) public User[] loadAllUsersOlderThan(int minAge);&#125;@Daopublic interface MyDao &#123; //区间中的值 @Query(&quot;SELECT * FROM user WHERE age BETWEEN :minAge AND :maxAge&quot;) public User[] loadAllUsersBetweenAges(int minAge, int maxAge); //或关系的查询 @Query(&quot;SELECT * FROM user WHERE first_name LIKE :search &quot; + &quot;OR last_name LIKE :search&quot;) public List&lt;User&gt; findUserWithName(String search);&#125; 如果,你不想查到表 行中所有字段,则1.定义一个实体1234567public class NameTuple &#123; @ColumnInfo(name=&quot;first_name&quot;) public String firstName; @ColumnInfo(name=&quot;last_name&quot;) public String lastName;&#125; 2.查询12345@Daopublic interface MyDao &#123; @Query(&quot;SELECT first_name, last_name FROM user&quot;) public List&lt;NameTuple&gt; loadFullName();&#125; 多表查询Querying multiple tables 123456789101112131415@Daopublic interface MyDao &#123; @Query(&quot;SELECT user.name AS userName, pet.name AS petName &quot; + &quot;FROM user, pet &quot; + &quot;WHERE user.id = pet.user_id&quot;) public LiveData&lt;List&lt;UserPet&gt;&gt; loadUserAndPetNames(); // You can also define this class in a separate file, as long as you add the // &quot;public&quot; access modifier. //注意 public static class UserPet &#123; public String userName; public String petName; &#125;&#125; 更新 更新指定条目 123456/** * 更新时间 * @param time */@Query(&quot;UPDATE search_history SET time = :time WHERE content = :content&quot;)void updateSearchHistory(String content,long time); 删除数据 删除所有数据 123456/** * 删除表 * @return */@Query(&quot;DELETE FROM filters&quot;)void delectFilters(); 删除最后一条 123456/** * 删除最后一个 * @return */@Query(&quot;DELETE FROM search_history WHERE time in(SELECT time FROM search_history ORDER BY time ASC LIMIT 1 )&quot;)void delectLastHistory(); 按条件删除 123456/** * 删除表by listtype * @return */@Query(&quot;DELETE FROM vehicle_model WHERE listType = :type&quot;)void delectVehicleByType(String type); ####补充 1.List&lt;String&gt;这样的元素1private ArrayList&lt;String&gt; tags; 这样的元素,可以通过Converter搞定 12345678910111213141516171819202122/*** If you have any questions, you can contact by email &#123; wangzhumoo@gmail.com&#125;** @author 王诛魔 2017/12/27 上午11:51*/public class TagsConverter &#123; @TypeConverter public static ArrayList&lt;String&gt; fromString(String value) &#123; Type listType = new TypeToken&lt;ArrayList&lt;String&gt;&gt;() &#123;&#125;.getType(); return new Gson().fromJson(value, listType); &#125; @TypeConverter public static String fromArrayList(ArrayList&lt;String&gt; list) &#123; Gson gson = new Gson(); String json = gson.toJson(list); return json; &#125;&#125; 在db中,会存为 123[&quot;精选&quot;][&quot;精选&quot;,&quot;急售&quot;][&quot;准新&quot;,&quot;SUV&quot;] 3.@Embedded 作用是,把已经写好的普通的类添加到数据表中.用Room的文档做说明: 123456789//这是一个标准的数据表@Entityclass User &#123; @PrimaryKey public int id; public String firstName;&#125; 其中只有id , firstName 而我想添加 street; state; city; postCode;刚好之前写了一个类叫Address 123456789class Address &#123; public String street; public String state; public String city; @Ignore public String nothing; @ColumnInfo(name = &quot;post_code&quot;) public int postCode;&#125; 那么我通过 @Embedded 12345678910@Entityclass User &#123; @PrimaryKey public int id; public String firstName; @Embedded public Address address;&#125; 表中就会有:names: id, firstName, street, state, city, and post_code 如果你想给@Embedded的类中所有元素前面加上统一的标志 @Embedded(prefix = &quot;address_&quot;) 表中就会有: names: id, firstName, address_street, address_state, address_city, and address_post_code 3.List&lt;Object&gt;这样的数据 解决方法google developer 真的给谷歌跪了,什么鬼文档 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061@Entitypublic class User &#123; // 这里是用户的 Id @PrimaryKey public int id; //省略 ...&#125;@Entitypublic class Book &#123; //书的id @PrimaryKey public int bookId; //这里就是这本书与 User的关系,这里的是User.id public int userId; public String name; public String desc;&#125;//注意,什么注解也不要加public class UserAndBooks &#123; //加入所有的user的属性 @Embedded public User user; //这里定义User 和 Book的关系 @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class) public List&lt;Book&gt; books; &#125;//文档上还讲了一个比较牛逼的功能,这里不讨论public class UserAndAllPets &#123; @Embedded public User user; @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class, projection = &#123;&quot;name&quot;&#125;) public List&lt;String&gt; bookNames; &#125;//然后,dao是这样的@Daopublic interface UserDao &#123; @Query(&quot;SELECT * FROM User&quot;) public List&lt;UserAndBooks&gt; loadUserWithBooks();&#125;PS:当然你存的时候,分辨别存User 和 Book 即可]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Room</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Retrofit2 + Okhttp3 + Rxjava2 网络请求封装(下)]]></title>
    <url>%2F2017%2F12%2F25%2FRetrofit2-Okhttp3-Rxjava2-%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85-%E4%B8%8B%2F</url>
    <content type="text"><![CDATA[1234567891011121314151617181920//请求:RetrofitApis.getNetworkApis().getFriendsCircle(userBean.token, String.valueOf(45),null,lastId) .compose(new DefaultTransformer&lt;&gt;()) .subscribe(new Defaultubscriber&lt;List&lt;FriendItem&gt;&gt;() &#123; @Override protected void onError(ApiException ex) &#123; //请求错误,ex中可以拿到code 和 msg 便于展示给用户 &#125; @Override public void onNext(List&lt;FriendItem&gt; friends) &#123; //请求成功,friends就是数据 &#125; @Override public void onComplete() &#123; //没有错误的话,最后会走着 &#125;&#125;); compose() 转化subscribe() 订阅 DefaultTransformer.java 1234567891011121314151617/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/11/3 下午5:06 * * 默认的切换线程,并返回实体类 */public class DefaultTransformer&lt;T extends ResultResponse&lt;RP&gt;, RP&gt; implements FlowableTransformer&lt;T, RP&gt; &#123; @Override public Publisher&lt;RP&gt; apply(Flowable&lt;T&gt; upstream) &#123; return upstream .map(t -&gt; t.getResult()) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()); &#125;&#125; 1.map 将返回的ResultResponse&lt;&gt; 转化,直接取ResultResponse的泛型实体1234&#123;&quot;result&quot;:&#123;&#125;&quot;code&quot;:&quot;&quot;,&quot;msg&quot;:&quot;&quot;&#125; 中的result 2.subscribeOn(Schedulers.io()) 网络请求的耗时操作,放在方便io操作的线程里面3.observeOn(AndroidSchedulers.mainThread()) 后面的操作,都在主线程进行 Defaultubscriber.java 123456789101112131415161718192021222324252627282930313233343536373839/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/24 上午10:36 * * 用于没有网络时停止网络请求 */public abstract class Defaultubscriber&lt;T&gt; extends DisposableSubscriber&lt;T&gt; &#123; @CallSuper @Override public void onError(Throwable e) &#123; if (e instanceof ApiException) &#123; onError((ApiException) e); &#125; else &#123; onError(new ApiException(&quot;&quot;,&quot;&quot;)); &#125; &#125; @Override protected void onStart() &#123; if (!SystemUtils.isNetworkConnected()) &#123; onError(new ApiException(Utils.getString(R.string.net_error_title),&quot;999&quot;)); cancel(); return; &#125; super.onStart(); &#125; /** * 错误回调 * * @param ex 异常信息 */ protected abstract void onError(ApiException ex);&#125; 1.extends DisposableSubscriber 便于通过CompositeDisposable管理请求,此处没有展示,不用管2.onStart() 中,判断是否有网络 没有网络onError(new ApiException(Utils.getString(R.string.net_error), false));抛出没有网络的错误,由各个页面自行处理 cancel(); 取消 有网络则继续 3.重写的 onError()中. 是ApiException实例的,是自己抛出的异常,已经处理过了,直接onError给各个页面处理 不是的再处理一次,在分发给各个页面处理 ####未完待续…]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Rxjava</tag>
        <tag>Okhttp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Retrofit2 + Okhttp3 + Rxjava2 网络请求封装(上)]]></title>
    <url>%2F2017%2F12%2F25%2FRetrofit2-Okhttp3-Rxjava2-%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85(%E4%B8%8A)%2F</url>
    <content type="text"><![CDATA[最终结构 1234567891011121314net├── RequestBuilder.java├── RetrofitApis.java├── base│ ├── ApiException.java│ ├── CustomGsonConverter.java│ ├── DefaultSubscriber.java│ └── DefaultTransformer.java└── response ├── BaseResponse.java └── ResultResponse.javaNetworkApis.java 1.添加依赖 1234567implementation &quot;io.reactivex.rxjava2:rxjava:2.1.7&quot;implementation &quot;io.reactivex.rxjava2:rxandroid:2.0.1&quot;implementation &quot;com.squareup.okhttp3:okhttp:3.9.0&quot;implementation &quot;com.squareup.okhttp3:logging-interceptor:3.9.0&quot;implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;implementation &quot;com.squareup.retrofit2:converter-gson:2.3.0&quot;implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot; 2.请求服务构建 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/11/1 下午11:13 * */public class RetrofitApis &#123; private static OkHttpClient okHttpClient = null; private static NetworkApis networkApis = null; private static Gson gson = new Gson(); private static final String TAG = &quot;RetrofitApis&quot;; /** * 为HOST创建一个请求客户端 * @return */ public static NetworkApis getNetworkApis() &#123; initOkhttp(); if (networkApis == null) &#123; Retrofit retrofit = new Retrofit.Builder() .client(okHttpClient) .baseUrl(Constants.HOST) .addConverterFactory(CustomGsonConverter.create(gson)) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .build(); networkApis = retrofit.create(NetworkApis.class); &#125; return networkApis; &#125; /** * 初始化一个OkHttpClient */ private static void initOkhttp()&#123; //没有创建就实例一个 if(okHttpClient == null)&#123; final OkHttpClient.Builder builder = new OkHttpClient.Builder(); //设置log等级 if(BuildConfig.DEBUG)&#123; HttpLoggingInterceptor interceptor = new HttpLoggingInterceptor(); //BODY 包含请求url 参数 response ,会打印在logcat interceptor.setLevel(HttpLoggingInterceptor.Level.BODY); builder.addInterceptor(interceptor); &#125; //打开一个File用于缓存 File cacheFile = new File(Constants.PATH_CACHE); Cache cache = new Cache(cacheFile,1024*1024*50); //一个拦截器 Interceptor cacheInterceptor = new Interceptor() &#123; @Override public Response intercept(Chain chain) throws IOException &#123; Request.Builder builder = chain.request().newBuilder(); if(SystemUtils.isNetworkConnected())&#123; int maxAge = 0 ; //有网络,不缓存,最长保存时间为0 builder.removeHeader(&quot;Pragma&quot;) .header(&quot;Cache-Control&quot;, &quot;public, max-age=&quot; + maxAge) .build(); &#125; else &#123; // 无网络时，设置超时为2周 int maxStale = 60 * 60 * 24 * 14; builder.removeHeader(&quot;Pragma&quot;) .header(&quot;Cache-Control&quot;, &quot;public, only-if-cached, max-stale=&quot; + maxStale) .build(); throw new ApiException(false); &#125; return chain.proceed(builder.build()); &#125; &#125;; //设置缓存拦截器 builder.addInterceptor(cacheInterceptor); builder.addNetworkInterceptor(cacheInterceptor); //这里通过Interceptor 可以实现添加公共参数,不详细说明了 //stetho,如果使用则需要添加 //builder.addNetworkInterceptor(new StethoInterceptor()); builder.cache(cache); //错误重连 builder.retryOnConnectionFailure(true); //设置超时 builder.connectTimeout(15, TimeUnit.SECONDS); builder.readTimeout(15, TimeUnit.SECONDS); builder.writeTimeout(15, TimeUnit.SECONDS); okHttpClient = builder.build(); &#125; &#125;&#125; 以上; 使用 CustomGsonConverter.java / NetworkApis.java通过getNetworkApis()方法,向外提供了一个请求服务.其中 .addConverterFactory(CustomGsonConverter.create(gson))是使用自定义的Converter替代了默认提供的 CustomGsonConverter.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/24 上午10:31 * * GsonConverter 用于在不解析返回正文的前提下获取请求成功失败和 返回信息 */public class CustomGsonConverter extends Converter.Factory &#123; private final Gson gson; private CustomGsonConverter(Gson gson) &#123; if (gson == null) &#123; throw new NullPointerException(&quot;gson == null&quot;); &#125; this.gson = gson; &#125; public static CustomGsonConverter create() &#123; return create(new Gson()); &#125; public static CustomGsonConverter create(Gson gson) &#123; return new CustomGsonConverter(gson); &#125; @Override public Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) &#123; TypeAdapter&lt;?&gt; adapter = gson.getAdapter(TypeToken.get(type)); return new CustomGsonResponseBodyConverter&lt;&gt;(gson, adapter); &#125; private class CustomGsonResponseBodyConverter&lt;T&gt; implements Converter&lt;ResponseBody, T&gt; &#123; private final Gson gson; private final TypeAdapter&lt;T&gt; adapter; public CustomGsonResponseBodyConverter(Gson gson, TypeAdapter&lt;T&gt; adapter) &#123; this.gson = gson; this.adapter = adapter; &#125; @Override public T convert(ResponseBody value) throws IOException &#123; String response = value.string(); BaseResponse baseResponse = gson.fromJson(response,BaseResponse.class); if (!baseResponse.isCodeSuccess()) &#123; value.close(); throw new ApiException(baseResponse.error); &#125; MediaType contentType = value.contentType(); Charset charset = contentType != null ? contentType.charset(UTF_8) : UTF_8; InputStream inputStream = new ByteArrayInputStream(response.getBytes()); Reader reader = new InputStreamReader(inputStream, charset); JsonReader jsonReader = gson.newJsonReader(reader); try &#123; return adapter.read(jsonReader); &#125; finally &#123; value.close(); &#125; &#125; &#125; @Nullable @Override public Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type, Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) &#123; return super.requestBodyConverter(type,parameterAnnotations,methodAnnotations,retrofit); &#125;&#125; requestBodyConverter没有重写,后面发现了一个bug,上传文件+文字参数时,可能会造成 Length出错.responseBodyConverter 重写,先把response解析,如果有问题则throw new ApiException(baseResponse.error);会主动走RxJava的 onError() 如果没有问题,则继续,好像有点多余…… ApiException.java 就是用于封装异常 1234567891011121314151617181920212223242526272829303132333435/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/24 上午10:29 * * 此类作为网络请求异常的基 */public class ApiException extends IOException &#123; String code; String msg; public ApiException(String code)&#123; this.code = code; &#125; public ApiException(String msg, String code)&#123; super(msg); this.msg = msg; this.code = code; &#125; public boolean getCode() &#123; return code; &#125; @Override public String getMessage() &#123; return msg; &#125;&#125; 3.Response返回数据的封装 这里根据后台返回数据结构 我们的返回是1234567&#123; &quot;result&quot;:&#123; &#125;, &quot;msg&quot;:&quot;请求成功&quot;, &quot;code&quot;:&quot;0000&quot;&#125; BaseResponse.java 123456789101112131415161718192021/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/19 下午5:41 * */public class BaseResponse&#123; public String code; public String msg; /** * API是否请求失败 * * @return 失败返回true, 成功返回false */ public boolean isCodeSuccess() &#123; return &quot;0000&quot;.equals(code); &#125;&#125; 所有的返回数据类,都要继承它,便于CustomGsonConverter 中判断返回数据的正确性 ResultResponse.java 1234567891011121314/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/19 下午5:37 */public class ResultResponse&lt;T&gt; extends BaseResponse &#123; private T result; public T getResult() &#123; return result; &#125;&#125; 通过T泛型,指定返回result的结构,让gson解析成实体对象 T 可能是 实体对象 可能是 List&lt;实体对象&gt; …. 4.请求数据 NetworkApis.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** * If you have any questions, you can contact by email &#123;wangzhumoo@gmail.com&#125; * @author 王诛魔 2017/10/19 下午5:40 * * 所有网络请求 */public interface NetworkApis &#123; /** * 获取朋友圈列表 * @param token * @return */ @POST(&quot;QCRL/qcrl?command=getFriendsCircle&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;List&lt;FriendItem&gt;&gt;&gt; getFriendsCircle( @Field(&quot;token&quot;) String token, @Field(&quot;number&quot;) String number, @Field(&quot;userId&quot;) String userId, @Field(&quot;lastDate&quot;) String lastId); /** * 删除 * @param token * @param circleId * @return */ @POST(&quot;QCRL/qcrl?command=updateFriendsCircle&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;String&gt;&gt; updateFriendsCircle( @Field(&quot;token&quot;) String token, @Field(&quot;circleId&quot;) String circleId); /** * 赞 * @param token * @param circleId * @param userId * @return */ @POST(&quot;QCRL/qcrl?command=addFavor&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;Object&gt;&gt; addFavor( @Field(&quot;token&quot;) String token, @Field(&quot;circleId&quot;) String circleId, @Field(&quot;toId&quot;) String userId); ...&#125; 根据自己的接口编写即可@POST() 指请求方式为 POST 注意,括号中的网址,开头不可以使用/QCRL/…否则会直接拼到HOST后面,url可能会错误 @FormUrlEncoded 表示form表单提交,会Encoded编码参数 @Field 每一个参数]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Rxjava</tag>
        <tag>Okhttp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android项目的build.gradle通用设置]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid%E9%A1%B9%E7%9B%AE%E7%9A%84build-gradle%E9%80%9A%E7%94%A8%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114apply plugin: &apos;com.android.application&apos;android &#123; //开启dataBinding dataBinding&#123; enabled = true &#125; defaultConfig &#123; //开启multiDex multiDexEnabled true //使用jni ndk &#123; //设置支持的SO库架构,这里的意思是只支持&apos;armeabi&apos;, &apos;armeabi-v7a&apos;, &apos;x86&apos; //这三种架构 abiFilters &apos;armeabi&apos;, &apos;armeabi-v7a&apos;, &apos;x86&apos; &#125; &#125; //设置一个编译的配置 signingConfigs &#123; //名为release的配置项 release &#123; //签名文件的位置,当前位置是根目录 storeFile file(&quot;/keyfile.jks&quot;) //storePassword storePassword &quot;xxxxxxxx&quot; //keyAlias keyAlias &quot;wangzhumo&quot; //keyPassword keyPassword &quot;xxxxxxxx&quot; //是否使用v2Signing v2SigningEnabled false &#125; &#125; //编译的版本 buildTypes &#123; //debug时的配置 debug &#123; minifyEnabled false //这里使用上面配置的签名,可以做到debug时,也使用的是正式签名,而不是debug的 keystore signingConfig signingConfigs.release //buildConfig 的一个参数,是否开启log buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;true&quot; proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; release &#123; // 显示Log minifyEnabled false signingConfig signingConfigs.release buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;false&quot; proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; &#125; //adb的配置项 adbOptions &#123; //超时时间 timeOutInMs = 5 * 1000 //adb install -r /path..apk installOptions &apos;-r&apos; &#125; flavorDimensions &apos;env&apos; productFlavors &#123; //正式版本 envydemo&#123; dimension &apos;env&apos; //此处是versionName versionName &quot;V1.1&quot; //manifestPlaceholders //是manifest已经定义的参数,这里给该参数赋值 manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;] //buildConfig 的参数,App当前的HOST地址 buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&apos;&quot;http://app....com/&quot;&apos; &#125; envtest &#123; dimension &apos;env&apos; versionName &quot;Test&quot; manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;] buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&apos;&quot;http://app.test....com/&quot;&apos; &#125; &#125; //自定义apk名字 android.applicationVariants.all &#123; variant -&gt; variant.outputs.all &#123; //apk的名字 outputFileName = &quot;App_$&#123;variant.versionName&#125;.apk&quot; &#125; &#125; android &#123; //排除 configurations.all &#123; resolutionStrategy.force &apos;com.google.code.findbugs:jsr305:1.3.9&apos; &#125; &#125; //使用java8 compileOptions &#123; sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 &#125;&#125; 以上代码,删除了常见的部分. buildConfigField 12345678910/** * 常量类 */public class Constants &#123; //取到在productFlavors.envyhcs配置的参数 //buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&apos;&quot;http://app....com/&quot;&apos; public static final String BASE_URL = BuildConfig.SERVER_HOST;&#125; manifestPlaceholders 123456789&lt;manifest&gt; &lt;application&gt; //取到在productFlavors.envyhcs配置的参数 //manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumo&quot;] &lt;meta-data android:name=&quot;UMENG_CHANNEL&quot; android:value=&quot;$&#123;UMENG_CHANNEL_VALUE&#125;&quot; /&gt; &lt;/application&gt;&lt;/manifest&gt; Build Variants在build.gradle中配置了productFlavors{ envdemo{} , envtest{}} 其中dimension一个维度其中buildTypes一个维度 debug + evndemodebug + evntestrelease + evndemerelease + evntest 共4种,其他的并没有使用到,所以不做说明 可以选择debug默认的版本…]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Gradle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android 项目统一管理依赖版本]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid-%E9%A1%B9%E7%9B%AE%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%2F</url>
    <content type="text"><![CDATA[准备引入Arouter,做一个组件的demo,就开始慢慢的改造项目 1234567891011121314151617.|-- app| |-- build.gradle| |-- libs| |-- src| | |-- androidTest| | |-- main| | `-- test||-- opensource| |-- build.gradle| |-- libs| `-- src| `-- main|-- build.gradle|-- settings.gradle`-- versions.gradle app 为主项目opensource 作为library存在,将来会成为baseLib的依赖,其中是所有的三方依赖,开源代码等等 1.根目录创建versions.gradle /versions.gradle 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150ext.deps = [:] def versions = [:] versions.arch = &quot;1.0.0&quot; versions.support = &quot;27.0.1&quot; versions.dagger = &quot;2.13&quot; versions.stetho = &quot;1.5.0&quot; versions.dialogs = &quot;0.9.6.0&quot; versions.glide = &quot;4.3.1&quot; versions.gradle = &quot;3.0.1&quot; versions.rxJava = &quot;2.1.7&quot; versions.rxAndroid = &quot;2.0.1&quot; versions.rxRelay = &quot;2.0.0&quot; versions.rxBinding = &quot;2.0.0&quot; versions.paging = &quot;1.0.0-alpha3&quot; versions.okhttp = &quot;3.9.0&quot; versions.retrofit = &quot;2.3.0&quot; versions.kotlin = &quot;1.2.0&quot; versions.kotlinBind = &quot;3.0.1&quot; versions.gson = &quot;2.8.2&quot; versions.arouterVersion = &quot;1.2.4&quot; versions.arouterProcessor = &quot;1.1.4&quot; versions.atslRunner = &quot;1.0.1&quot; versions.atslRules = &quot;1.0.1&quot; versions.hamcrest = &quot;1.3&quot; versions.timber = &quot;4.5.1&quot; versions.mockwebserver = &quot;3.8.1&quot; versions.apache_commons = &quot;2.5&quot; versions.mockito = &quot;2.7.19&quot; versions.mockito_all = &quot;1.10.19&quot; versions.dexmaker = &quot;2.2.0&quot; versions.constraint = &quot;1.0.2&quot; versions.junit = &quot;4.12&quot; versions.espresso = &quot;3.0.1&quot; def deps = [:] def rxLib = [:] rxLib.rxJava = &quot;io.reactivex.rxjava2:rxjava:$versions.rxJava&quot; rxLib.rxAndroid = &quot;io.reactivex.rxjava2:rxandroid:$versions.rxAndroid&quot; rxLib.rxBinding = &quot;com.jakewharton.rxbinding2:rxbinding:$versions.rxBinding&quot; rxLib.rxBingingV4 = &quot;com.jakewharton.rxbinding2:rxbinding-support-v4:$versions.rxBinding&quot; rxLib.rxBingingRecycler = &quot;com.jakewharton.rxbinding2:rxbinding-recyclerview-v7:$versions.rxBinding&quot; rxLib.rxBingingV7 = &quot;com.jakewharton.rxbinding2:rxbinding-appcompat-v7:$versions.rxBinding&quot; rxLib.rxBingingDesign = &quot;com.jakewharton.rxbinding2:rxbinding-design:$versions.rxBinding&quot; rxLib.rxRelay = &quot;com.jakewharton.rxrelay2:rxrelay:$versions.rxRelay&quot; deps.rxLibs = rxLib def support = [:] support.annotations = &quot;com.android.support:support-annotations:$versions.support&quot; support.appCompat = &quot;com.android.support:appcompat-v7:$versions.support&quot; support.recyclerview = &quot;com.android.support:recyclerview-v7:$versions.support&quot; support.cardview = &quot;com.android.support:cardview-v7:$versions.support&quot; support.design = &quot;com.android.support:design:$versions.support&quot; support.v4 = &quot;com.android.support:support-v4:$versions.support&quot; support.coreUtils = &quot;com.android.support:support-core-utils:$versions.support&quot; deps.support = support def archLib = [:] archLib.archExtensions = &quot;android.arch.lifecycle:extensions:$versions.arch&quot; archLib.archRoomRuntime = &quot;android.arch.persistence.room:runtime:$versions.arch&quot; archLib.archRoomCompiler = &quot;android.arch.persistence.room:compiler:$versions.arch&quot; archLib.archLifecycleCommon = &quot;android.arch.lifecycle:common-java8:$versions.arch&quot; deps.archLibs = archLib def glide = [:] glide.glide = &quot;com.github.bumptech.glide:glide:$versions.glide&quot; glide.glideCompiler = &quot;com.github.bumptech.glide:compiler:$versions.glide&quot; deps.glide = glide def stethos = [:] stethos.stetho = &quot;com.facebook.stetho:stetho:$versions.stetho&quot; stethos.stethoHttp = &quot;com.facebook.stetho:stetho-okhttp3:$versions.stetho&quot; deps.stetho = stethos def okhttp = [:] okhttp.okhttp = &quot;com.squareup.okhttp3:okhttp:$versions.okhttp&quot; okhttp.okhttpLogging = &quot;com.squareup.okhttp3:logging-interceptor:$versions.okhttp&quot; deps.okhttp = okhttp def retrofit = [:] retrofit.retrofit = &quot;com.squareup.retrofit2:retrofit:$versions.retrofit&quot; retrofit.converterGson = &quot;com.squareup.retrofit2:converter-gson:$versions.retrofit&quot; retrofit.adapterRxjava = &quot;com.squareup.retrofit2:adapter-rxjava2:$versions.retrofit&quot; deps.retrofit = retrofit def arouter = [:] arouter.runtime = &quot;com.alibaba:arouter-api:$versions.arouterVersion&quot; arouter.compiler = &quot;com.alibaba:arouter-compiler:$versions.arouterProcessor&quot; deps.arouter = arouter def dagger = [:] dagger.dagger = &quot;com.google.dagger:dagger:$versions.dagger&quot; dagger.daggerAndroid = &quot;com.google.dagger:dagger-android:$versions.dagger&quot; dagger.daggerAndroidSupport = &quot;com.google.dagger:dagger-android-support:$versions.dagger&quot; dagger.daggerCompiler = &quot;com.google.dagger:dagger-compiler:$versions.dagger&quot; dagger.daggerAndroidCompiler = &quot;com.google.dagger:dagger-android-processor:$versions.dagger&quot; deps.dagger = dagger def kotlin = [:] kotlin.kotlinStdlib = &quot;org.jetbrains.kotlin:kotlin-stdlib-jre8:$versions.kotlin&quot; kotlin.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot; kotlin.kotlinDatabind = &quot;com.android.databinding:compiler:$versions.kotlinBind&quot; deps.kotlin = kotlin def espresso = [:] espresso.core = &quot;com.android.support.test.espresso:espresso-core:$versions.espresso&quot; espresso.contrib = &quot;com.android.support.test.espresso:espresso-contrib:$versions.espresso&quot; espresso.intents = &quot;com.android.support.test.espresso:espresso-intents:$versions.espresso&quot; deps.espresso = espresso def atsl = [:] atsl.runner = &quot;com.android.support.test:runner:$versions.atsl_runner&quot; atsl.rules = &quot;com.android.support.test:rules:$versions.atsl_runner&quot; deps.atsl = atsl deps.multidex = &quot;com.android.support:multidex:1.0.1&quot; deps.dialog = &quot;com.afollestad.material-dialogs:core:$versions.dialogs&quot; deps.gson = &quot;com.google.code.gson:gson:$versions.gson&quot; deps.paging = &quot;android.arch.paging:runtime:$versions.paging&quot; deps.dexmaker = &quot;com.linkedin.dexmaker:dexmaker-mockito:$versions.dexmaker&quot; deps.constraint = &quot;com.android.support.constraint:constraint-layout:$versions.constraint&quot; deps.timber = &quot;com.jakewharton.timber:timber:$versions.timber&quot; deps.gradlePlugin = &quot;com.android.tools.build:gradle:$versions.gradle&quot; deps.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot; ext.deps = deps def buildVersions = [:] buildVersions.minSDK = 14 buildVersions.targetSDK = 26 buildVersions.compileSDK = 27 buildVersions.buildTools = &quot;26.0.2&quot; ext.buildVersion = buildVersions def addRepos(RepositoryHandler handler) &#123; handler.google() handler.jcenter() handler.mavenCentral() handler.maven &#123; url &apos;https://oss.jfrog.org/libs-snapshot&apos; &#125; handler.maven &#123; url &apos;https://jitpack.io&apos; &#125; &#125; ext.addRepos = this.&amp;addRepos 其中声明了所有已经用到,或者可能使用的Lib版本,以及Android sdk tools 的版本. 2.将声明的版本,添加到项目中,方便引用 /build.gradle 项目的build.gradle中 12345678910111213141516171819buildscript &#123; //加入引用 apply from: &apos;versions.gradle&apos; //添加rep addRepos(repositories) dependencies &#123; //由versions.gradle管理的版本 classpath deps.gradlePlugin classpath deps.kotlinPlugin // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files &#125;&#125;allprojects &#123; //添加rep addRepos(repositories)&#125; 3.对Android Tools,SDK版本的控制项目/app/build.gradle 12345678910111213141516android &#123; //sdk的版本 compileSdkVersion buildVersion.compileSDK //tools的版本 buildToolsVersion buildVersion.buildTools defaultConfig &#123; //sdk版本 minSdkVersion buildVersion.minSDK targetSdkVersion buildVersion.targetSDK versionCode 1 //也可以使用 versionName &quot;1.0&quot; &#125;//&#125; 4.其他Lib的依赖按照这样的格式即可 123456789101112131415161718192021222324252627282930313233dependencies &#123; //support api deps.support.appCompat api deps.support.recyclerview api deps.support.cardview api deps.support.design api deps.multidex api deps.constraint //rxjava api deps.rxLibs.rxJava api deps.rxLibs.rxAndroid api deps.rxLibs.rxRelay //http api deps.okhttp.okhttp api deps.okhttp.okhttpLogging api deps.retrofit.retrofit api deps.retrofit.converterGson api deps.retrofit.adapterRxjava api deps.gson //arch api deps.archLibs.archExtensions api deps.archLibs.archRoomRuntime api deps.archLibs.archLifecycleCommon annotationProcessor deps.archLibs.archRoomCompiler //stetho api deps.stetho.stetho api deps.stetho.stethoHttp //dialog api deps.dialog //glide api deps.glide.glide annotationProcessor deps.glide.glideCompiler&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Gradle</tag>
        <tag>组件化</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[常用的Google Chrome 浏览器插件]]></title>
    <url>%2F2017%2F12%2F25%2F%E5%B8%B8%E7%94%A8%E7%9A%84Google-Chrome-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[###几个比较常用的Chrome插件 1.AdBlock 最受欢迎的Chrome扩展，拥有超过4000万用户！屏蔽整个互联网上的广告。 推荐: ★★★ 2.Insight.io for Github Improve GitHub code browsing experienc.通过插件可以在github的项目页面上,结构化的查看代码,甚至还有”引用”,”查找”等等功能.就像是把github项目页,变成了一个只能查看的ide.对了,还能很方便的下载单个文件 推荐: ★★★★★ 3.Infinity新标签页 重新定义了新标签页，一个追求极简美学和一站式服务体验更少的东西体验更多的功能。 简洁,方便,实用 推荐:★★★★ 4.PostmanPostman makes API development faster, easier, and better. 更快…..哈哈超级方便,模拟请求的App,支持post get,可以测试文件上传等还有比较方便的一点是,可以生成当前请求的okhttp代码,虽然只能作参考….. 推荐:★★★★★ 和它一样的还有Restlet Client - REST API Testing 5.BaiduExporter可以方便的把网盘的下载地址导出到aria2/aria2-rpc，支持YAAW。配合Aria2GUI,可以高速下载百度云限速的文件.. 虽然还能用,但是作者说不维护了,还有替代品:Aria2c Integration没有用过,不知道是否可用. Aria2GUIGithub : https://github.com/aria2/aria2 推荐:★★★★★ 其他推荐:★★★ SingleFileArchive a complete page into a single HTML file可以将网页保存为单文件,方便保存 印象笔记·剪藏使用印象笔记扩展程序一键保存精彩网页内容到印象笔记帐户。 JSON FormatterChrome extension for printing JSON and JSONP nicely when you visit it ‘directly’ in a browser tab.Github : https://github.com/callumlocke/json-formatter]]></content>
      <categories>
        <category>语言工具</category>
      </categories>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jni使用指南,关于.so你应该知道的]]></title>
    <url>%2F2017%2F12%2F25%2Fjni%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97-%E5%85%B3%E4%BA%8E-so%E4%BD%A0%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84%2F</url>
    <content type="text"><![CDATA[其实这些都是Android设备CPU的: armeabi: 早期的手机用的比较多,针对普通的或旧的arm v5 cpu,。 armeabiv-v7a:目前主流版本 2011年以后的生产的大部分设备,针对有浮点运算或高级扩展功能的arm v7 cpu. arm64-v8a: 8代、64位ARM处理器，64位支持. x86: 我们见到的模拟器大多就是这个。 x86_64: 64位的平板。 然后特意说一下x86系列的,是兼容arm的,但是性能损失特别大. Android加载.so的原则同一目录下要么所有使用jni的项目都给加上.so文件,要么你就别给这个目录,也就是只要不齐全就都干掉比如你的lib结构是这样的 123456libs -armeabi -aaa.so -bbb.so -arm64-v8a -aaa.so 其实这种情况就是属于同一目录下,提供的.so文件不全…然而很容易出现,毕竟有些三方啊什么的,提供的.so文件并不齐全,这样的话同一个架构目录下会缺少一个或多个.so文件. Android在加载某个使用jni的功能时,你并没有提供x86的.so文件,但是你有x86这个目录,那就会去x86目录下去找,没有啊然后就异常了. Android加载.so的目录1.我自己用的是 也就是自己在app -&gt; src -&gt; main 下自己建立一个目录: jniLibs然后放进去即可. 2.就是通常放在libs目录下了别忘了在build.gradle文件中设置 jniLibs.srcDir Android排除某架构的.so 1234567891011android &#123; ... defaultConfig &#123; ... ndk &#123; // 设置支持的 SO 库构架 abiFilters &apos;armeabi&apos;, &apos;armeabi-v7a&apos; // &apos;arm64-v8a&apos;, &apos;x86&apos;, &apos;x86_64&apos;, &apos;mips&apos;, &apos;mips64&apos; &#125; &#125; &#125; 如果编译报1NDK integration is deprecated in the current plugin. gradle.properties 文件中添加：1android.useDeprecatedNdk=true 应该还有其他方法排除,我也就知道这一种,如果有知道其他方法的,请告知一下,谢谢]]></content>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[EditText的输入属性InputType以及imeOptions]]></title>
    <url>%2F2017%2F12%2F25%2FEditText%E7%9A%84%E8%BE%93%E5%85%A5%E5%B1%9E%E6%80%A7InputType%E4%BB%A5%E5%8F%8AimeOptions%2F</url>
    <content type="text"><![CDATA[EditText的输入属性1234567android:imeOptions=&quot;flagNoExtractUi&quot; //使软键盘不全屏显示，只占用部分屏幕android:imeOptions=&quot;actionNone&quot; //输入框右侧不带任何提示android:imeOptions=&quot;actionGo&quot; //右下角按键内容为&apos;开始&apos;android:imeOptions=&quot;actionSearch&quot; //右下角按键为搜索android:imeOptions=&quot;actionSend&quot; //右下角按键内容为&apos;发送&apos;android:imeOptions=&quot;actionNext&quot; //右下角按键内容为&apos;下一步&apos;android:imeOptions=&quot;actionDone&quot; //右下角按键内容为&apos;完成&apos; EditText的inputType属性12345678910111213141516171819202122232425262728293031&lt;EditText android:inputType=&quot;phone&quot; //电话号码 android:inputType=&quot;none&quot; android:inputType=&quot;text&quot; //文本类型 android:inputType=&quot;textCapCharacters&quot; //字母大写 android:inputType=&quot;textCapWords&quot; //首字母大写 android:inputType=&quot;textCapSentences&quot; //仅第一个字母大写 android:inputType=&quot;textAutoCorrect&quot; //自动完成 android:inputType=&quot;textAutoComplete&quot; //自动完成 android:inputType=&quot;textMultiLine&quot; //多行输入 android:inputType=&quot;textImeMultiLine&quot; //输入法多行 android:inputType=&quot;textNoSuggestions&quot; //不提示 android:inputType=&quot;textUri&quot; //网址 android:inputType=&quot;textEmailAddress&quot; //电子邮件地址 android:inputType=&quot;textEmailSubject&quot; //邮件主题 android:inputType=&quot;textShortMessage&quot; //短讯 android:inputType=&quot;textLongMessage&quot; //长信息 android:inputType=&quot;textPersonName&quot; //人名 android:inputType=&quot;textPostalAddress&quot; //地址 android:inputType=&quot;textPassword&quot; //密码 android:inputType=&quot;textVisiblePassword&quot; //可见密码 android:inputType=&quot;textWebEditText&quot; //作为网页表单的文本 android:inputType=&quot;textFilter&quot; //文本筛选过滤 android:inputType=&quot;textPhonetic&quot; //拼音输入 android:inputType=&quot;number&quot; //数字 android:inputType=&quot;numberSigned&quot; //带符号数字格式 android:inputType=&quot;numberDecimal&quot; //带小数点的浮点格式 android:inputType=&quot;datetime&quot; //时间日期 android:inputType=&quot;date&quot; //日期键盘 android:inputType=&quot;time&quot; //时间键盘 /&gt;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TextView中的文字颜色,点击,斜体等实现--SpannableString]]></title>
    <url>%2F2017%2F12%2F25%2FTextView%E4%B8%AD%E7%9A%84%E6%96%87%E5%AD%97%E9%A2%9C%E8%89%B2-%E7%82%B9%E5%87%BB-%E6%96%9C%E4%BD%93%E7%AD%89%E5%AE%9E%E7%8E%B0-SpannableString%2F</url>
    <content type="text"><![CDATA[一般实现方式如下:12String html = &quot;文字&lt;font color=\&quot;red\&quot;&gt;变色&lt;/font&gt;的效果&quot;;tvMainShow.setText(Html.fromHtml(html)); 使用Html的方式来实现,简单的还好,复杂一点的真的很不方便 Google显然早就已经想到了这样的问题,所以 SpannedString &amp; SpannableStringBuilder 就是干这个的 他们都实现了 CharSequence,眼熟么? text)```.也就是说,你可以直接赋值给TextView123456789101112他们两个的区别就是 This is the class for text whose content is immutable but to which markup objects can be attached and detached. For mutable text, see SpannableStringBuilder文档说的很清楚了,就是CharSequence是固定长度的,一旦通过 new SpannableString(&quot;设置文字&quot;);则不可以更改文字内容,而SpannableStringBuilder是可以的,个人理解比较像String 和 StringBuilder 的关系###不多说了,开搞:**1.设置文字**&gt;SpannableString spannableString = new SpannableString(&quot;文字的前景色与背景色&quot;);---**2.通过setSpan来修改文字的样式**```setSpan [Object what, int start, int end, int flags) flags:Spannable.SPAN_EXCLUSIVE_EXCLUSIVE：前后都不包括Spannable.SPAN_EXCLUSIVE_INCLUSIVE ：前面不包括Spannable.SPAN_INCLUSIVE_EXCLUSIVE ：前面包括Spannable.SPAN_INCLUSIVE_INCLUSIVE ：前后都包括 为了说明这四个参数,有例子如下: 代码如下:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162/* * * @author 王诛魔 2017/1/21 上午11:31 * @e-mail phyooos@163.com */public class MainActivity extends AppCompatActivity &#123; @BindView(R.id.edit_show) EditText etMainShow; @BindView(R.id.tab_view) TabLayout tabLayout; @Override public void onCreate(@Nullable Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE); tabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123; @Override public void onTabSelected(TabLayout.Tab tab) &#123; switch (tab.getPosition()) &#123; case 0: showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE); break; case 1: showText(Spannable.SPAN_EXCLUSIVE_INCLUSIVE); break; case 2: showText(Spannable.SPAN_INCLUSIVE_EXCLUSIVE); break; case 3: showText(Spannable.SPAN_INCLUSIVE_INCLUSIVE); break; &#125; &#125; @Override public void onTabUnselected(TabLayout.Tab tab) &#123; &#125; @Override public void onTabReselected(TabLayout.Tab tab) &#123; &#125; &#125;); &#125; /** * 展示文字 */ private void showText(int type) &#123; //构造SpannableString SpannableString spanString = new SpannableString(&quot;这里是王诛魔的简书文章&quot;); //字体颜色的Span ForegroundColorSpan span = new ForegroundColorSpan(Color.RED); //指定范围 spanString.setSpan(span, 3, 6, type); //设置给EditText显示出来 etMainShow.setText(spanString); &#125;&#125; 上面的代码中:123456//字体颜色的SpanForegroundColorSpan span = new ForegroundColorSpan(Color.RED);ForegroundColorSpan就是设置的文字样式,,这个是前景色,,也就是字体的颜色//指定范围spanString.setSpan(span, 3, 6, type);这里的三个参数已经在上面说过了,通过上面的代码也会发现,其实3,6 其中下标3是包含的,而下标6就不会改变 3.至于Span的这些个样式在哪里找,请看文档:关键词:CharacterStyle https://developer.android.com/reference/android/text/style/CharacterStyle.html 说几个常用的吧: ForegroundColorSpan 字体颜色 BackgroundColorSpan 字体背景色设置 AbsoluteSizeSpan 字体大小 StyleSpan 粗体等1234567891011121314//字体由Typeface来控制StyleSpan span = new StyleSpan(Typeface.BOLD_ITALIC);- UnderlineSpan 下划线- ImageSpan 图片置换[ImageSpan https://developer.android.com/reference/android/text/style/ImageSpan.html](https://developer.android.com/reference/android/text/style/ImageSpan.html)这个有一点不同,它是将文字中的指定部分替换为一个图片,至于如何构造请参考文档让我想起来了那个EmojiEditText的库,其实可以用这个ImageSpan实现一个简单的可以显示表情的TextView- ClickableSpan 点击 //这个有些不同,需要class CustomClickable extends ClickableSpan { @Override public void updateDrawState(TextPaint ds) { //这里其实还可以对可点击部分设置一些东西 } @Override public void onClick(View widget) { ...do something } } //对了,加上这行代码TextView.setMovementMethod(LinkMovementMethod.getInstance());//要不点不动哦 ``` URLSpan 这个完全可以用ClickableSpan实现 SpannableStringBuilder SpannableString都说的这么明白了,SpannableStringBuilder就省了 ####End]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flutter 安装]]></title>
    <url>%2F2017%2F12%2F25%2FFlutter-%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[使用系统Mac OS 已经没办法给大家看问题了,我在github上提了问题. github issue 12345678使用命令 command`flutter doctor`异常:exceptionSocketException: SocketException: Connection failed (OS Error: No route to host, errno = 65), address = android.googlesource.com, port = 443 总的来说就是下载 Downloading Gradle Wrapper…的时候连接不到外网,以至于失败 github上的这位小哥提醒了我@lishuhao @eseidelGoogleit’s reachable via https from ChromeMaybe his chrome use proxy but terminal not use proxy. 我确实开了ss,但是终端确实连接不到代理的,不走代理,那当然无解 ##解决: ####1.Mac下使用Homebrew安装 1brew install polipo ####2.修改配置 1ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents 1vim /usr/local/opt/polipo/homebrew.mxcl.polipo.plist 在配置文件中添加&lt;string&gt;socksParentProxy=localhost:1086&lt;/string&gt; 其中1086这个端口号,自己去看 ####3.启动 1launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist ####4.使用 1234567$ http_proxy=http://localhost:8123 curl ip.gsCurrent IP / 当前 IP: 47.90.88.133ISP / 运营商: ALIYUNCity / 城市: Hong KongCountry / 国家: ChinaIP.GS is now IP.SB, please visit https://ip.sb/ for more IP information, ip.gs will only use for curl purpose. / IP.GS 已更新至 IP.SB 请访问 https://ip.sb/ 获取更多信息, ip.gs 域名仅作 curl 使用Please join Telegram group https://t.me/sbfans if you have any issues. / 如有问题，请加入 Telegram 群 https://t.me/sbfans 可以看到,现在我是香港的IP了,http_proxy=http://localhost:8123这个是提供默认的,至于怎么修改我没有看,也不知道 把代理设置为全局的1234567891011121314151617181920212223~ ⌚ 11:42:51$ export http_proxy=http://localhost:8123~ ⌚ 11:43:02$ export https_proxy=http://localhost:8123~ ⌚ 11:43:09$ curl https://www.google.com&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;https://www.google.com.hk/?gfe_rd=cr&amp;ei=5FaaWZDNOMLU8Af_nriwDw&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt;~ ⌚ 11:43:33$ curl www.google.com&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;http://www.google.com.hk/?gfe_rd=cr&amp;ei=6laaWZqEO8_U8AeLlID4CA&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt; ####5.End ##见证奇迹的时刻到了 12345678910111213141516171819202122232425262728293031323334353637383940414243444546~/develop/flutter on  alpha! ⌚ 11:44:11$ flutter doctorDownloading Gradle Wrapper... 1.3s[✓] Flutter (on Mac OS X 10.12.6 16G29, locale zh-Hans-CN, channel alpha) • Flutter at /Users/phyooos/develop/flutter • Framework revision b156a0f054 (9 days ago), 2017-08-11 22:01:40 -0700 • Engine revision fef7d827d6 • Tools Dart version 1.25.0-dev.9.0[✓] Android toolchain - develop for Android devices (Android SDK 26.0.1) • Android SDK at /Users/phyooos/Library/Android/sdk • Platform android-26, build-tools 26.0.1 • ANDROID_HOME = /Users/phyooos/Library/Android/sdk • Java binary at: /Applications/Android Studio.app/Contents/jre/jdk/Contents/Home/bin/java • Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06)[-] iOS toolchain - develop for iOS devices ✗ Xcode installation is incomplete; a full installation is necessary for iOS development. Download at: https://developer.apple.com/xcode/download/ Or install Xcode via the App Store. Once installed, run: sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer ✗ libimobiledevice and ideviceinstaller are not installed or require updating. To update, run: brew uninstall --ignore-dependencies libimobiledevice brew install --HEAD libimobiledevice brew install ideviceinstaller ✗ ios-deploy not installed. To install: brew install ios-deploy ✗ CocoaPods not installed. CocoaPods is used to retrieve the iOS platform side&apos;s plugin code that responds to your plugin usage on the Dart side. Without resolving iOS dependencies with CocoaPods, plugins will not work on iOS. For more info, see https://flutter.io/platform-plugins To install: brew install cocoapods pod setup[✓] Android Studio (version 2.3) • Android Studio at /Applications/Android Studio.app/Contents • Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06)[✓] IntelliJ IDEA Ultimate Edition (version 2017.1.3) • Flutter plugin version 16.0 • Dart plugin version 171.4424.63[✓] Connected devices • None 我的Flutter就ok了]]></content>
      <categories>
        <category>语言工具</category>
      </categories>
      <tags>
        <tag>Server</tag>
        <tag>Google</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BottomNavigationView使用指南]]></title>
    <url>%2F2017%2F12%2F25%2FBottomNavigationView%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[最终效果: Android Support Library 25 以上的support包中增加了 BottomNavigationView所以你必须使用com.android.support:design:25.0.0以上的版本才能玩 1.在 build.gradle 文件中增加依赖： 'com.android.support:design:25.0.0'```122.在main_activity.xml中添加: 123- 其中```app:menu=&quot;@menu/menu_tab_button&quot;```决定了展示几个item,都长什么样- 其中,分别决定**图标和文字**选中和未选中item的状态,颜色 app:itemIconTint=”@color/nav_color_select”app:itemTextColor=”@color/nav_color_select”1234- 其中```app:itemBackground=&quot;@color/text_white_color&quot;```则是整个view的背景颜色3.menu_tab_button.xml的代码如下: &lt;?xml version=”1.0” encoding=”utf-8”?&gt; &lt;item android:id=&quot;@+id/mian_tab_paidui&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_paidui&quot; //文字内容 android:icon=&quot;@drawable/paidui&quot;/&gt; //icon图标 &lt;item android:id=&quot;@+id/mian_tab_find&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_faxiang&quot; android:icon=&quot;@drawable/faxian&quot;/&gt; &lt;item android:id=&quot;@+id/mian_tab_more&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_more&quot; android:icon=&quot;@drawable/more&quot;/&gt; 12345678###然而,你以为会这么简单?? shiftingMode教你做人()###这个只会在item个数超过3个才会出现.![牛逼的特效(shiftingMode).gif](http://upload-images.jianshu.io/upload_images/2520304-464b090fa4c8919c.gif?imageMogr2/auto-orient/strip)4.这让我如何是好?看了半天,在网上找到一个方法. /** 一个关于BottomNavigationView的帮助类,用来关闭shiftingMode @author 王诛魔 2017/2/10 下午6:35 @e-mail phyooos@163.com*/ public class BNVHelper { public static void disableShiftMode(BottomNavigationView navigationView) { BottomNavigationMenuView menuView = (BottomNavigationMenuView) navigationView.getChildAt(0); try { Field shiftingMode = menuView.getClass().getDeclaredField(&quot;mShiftingMode&quot;); shiftingMode.setAccessible(true); shiftingMode.setBoolean(menuView, false); shiftingMode.setAccessible(false); for (int i = 0; i &lt; menuView.getChildCount(); i++) { BottomNavigationItemView itemView = (BottomNavigationItemView) menuView.getChildAt(i); itemView.setShiftingMode(false); itemView.setChecked(itemView.getItemData().isChecked()); } } catch (NoSuchFieldException e) { // Log } catch (IllegalAccessException e) { // Log } } }1234567891011121314原作者@[ChristmasJason](http://www.jianshu.com/u/4d132a94e6e8):http://www.jianshu.com/p/e2a8791e80d6然后我看了一下源码**mShiftingMode** 这个布尔值决定了是否启用shiftingMode,所以上面的方法就是shiftingMode.setBoolean(menuView, false);然后就好了......提示:google说选中图标的颜色是这么改的,然而都是骗人的,这个应该是默认的设置,我也偷懒没有验证![2017-02-21_17-59-10.png](http://upload-images.jianshu.io/upload_images/2520304-c6c71ad14a9e0106.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) app:itemIconTint=”@color/nav_color_select”app:itemTextColor=”@color/nav_color_select”123其实你配置了之后,就是这个东西来决定的,而不是app&apos;s primary colornav_color_select.xml这就是个选择器,代码如下: &lt;?xml version=”1.0” encoding=”utf-8”?&gt; ``` ####End,到这里你的导航条也应该ok了]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Studio 使用正式签名debug调试]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid-Studio-%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%BC%8F%E7%AD%BE%E5%90%8Ddebug%E8%B0%83%E8%AF%95%2F</url>
    <content type="text"><![CDATA[###解决问题: 很多时候我们使用第三方登录什么的东西,需要我们提供正式签名,但是我们总是需要调试的.一般情况,我们不可能一次性OK,那么每一次调试都需要正式签名打包,并安装,然后再调试,这也太麻烦了,. 所以,直接上代码: 1234567891011121314151617181920signingConfigs &#123; release &#123; keyAlias &apos;phyooos&apos; keyPassword &apos;phyooos&apos; storeFile file(&apos;phyooos.jks&apos;) storePassword &apos;phyooos&apos; &#125; &#125; buildTypes &#123; release &#123; minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; debug&#123; minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; &#125; 解释一下: 12345678signingConfigs &#123; release &#123; keyAlias &apos;phyooos&apos; keyPassword &apos;phyooos&apos; storeFile file(&apos;phyooos.jks&apos;) storePassword &apos;phyooos&apos; &#125; &#125; 这一段代码写在项目app目录下&gt;gradle配置文件中&gt;android节点下,是我们自定义的一个配置 keyAlias ‘phyooos’ 这是签名文件的Alias keyPassword ‘phyooos’ 这是签名文件的密码 storeFile file(‘phyooos.jks’) 这个就是签名文件的地址,我放在app目录下了 storePassword ‘phyooos’ 这是store密码 123456789101112buildTypes &#123; release &#123; minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; debug&#123; minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; &#125; 这一段的意思就是debug调试以及正式打包都使用上面自定义的配置 The End 好了,愉快的玩耍吧]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android Studio</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[低功耗蓝牙iBeacon的开发笔记]]></title>
    <url>%2F2017%2F12%2F25%2F%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99iBeacon%E7%9A%84%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[###1.挣扎的开始各种百度,google,发现国内资料很少,有的也是商业公司提供的sdk,这并不符合我需要,google倒是不少,然而以我的英语水平,望洋兴叹罢了@不发牢骚了: 首先你需要了解这些资料1、profileprofile可以理解为一种规范，一个标准的通信协议，它存在于从机中。蓝牙组织规定了一些标准的profile，例如 HID OVER GATT ，防丢器 ，心率计等。每个profile中会包含多个service，每个service代表从机的一种能力。 2、serviceservice可以理解为一个服务，在ble从机中，通过有多个服务，例如电量信息服务、系统信息服务等，每个service中又包含多个characteristic特征值。每个具体的characteristic特征值才是ble通信的主题。比如当前的电量是80%，所以会通过电量的characteristic特征值存在从机的profile里，这样主机就可以通过这个characteristic来读取80%这个数据 3、characteristiccharacteristic特征值，ble主从机的通信均是通过characteristic来实现，可以理解为一个标签，通过这个标签可以获取或者写入想要的内容。 4、UUIDUUID，统一识别码，我们刚才提到的service和characteristic，都需要一个唯一的uuid来标识PS: 百度到的,我以一个过来人的身份保证这个很重要 ###2.资料,准备资料看这里: 这也是最重要的资料来源,谷歌SDK的例子里面有的项目 接上文,说完资料, 这是一个很好的demosdk\samples\android-22\connectivity\BluetoothLeGatt 该目录下为谷歌提供的demo,我的应用也是在它的基础上改进而成的.由以下部分组成:1.一个服务 BluetoothLeService,主负责与蓝牙设备进行数据交换 2.两个activity:DeviceControlActivity,DeviceScanActivity 见名知意,一个负责扫描设备,而两外一个与设备进行交互 3.一个SampleGattAttributes 主要是存储了一些UUID,我对它进行了加强 ###3.BLE设备的使用步骤概况1.首先要说明的一点是,要求Android版本为4.3及其以上 接着确认设备支持12345678910111213/** * 支持BLE * check to determine whether BLE is supported on the device */public void isSupported()&#123; if (!getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE)) &#123; Toast.makeText(this, &quot;设备不支持BLE功能&quot;, Toast.LENGTH_SHORT).show(); &#125; &#125;``` 2.确认手机支持并打开蓝牙的状态下,你就可以进行设备的搜索了 有两种模式 //第一种//serviceUuids 指定设备的UUID//callback 搜索的回调startLeScan(final UUID[] serviceUuids, final LeScanCallback callback) //第二种//其实就是不传入serviceUuids的,就是说搜索范围内所有蓝牙设备public boolean startLeScan(LeScanCallback callback) { return startLeScan(null, callback);} 1233.同时记得停止搜索,当然你也可以一直搜PS：其实我见到的app大部分是不停的搜索，这样的话会有一个广播数据持续刷新的效果,那么很多的距离判断什么的都是通过这种不停搜索的形式来工作的 //mBluetoothAdapter 请自行查看谷歌文档//mLeScanCallback 这就是上面提过的LeScanCallback的实例mBluetoothAdapter.stopLeScan(mLeScanCallback);12接着就是在回调中拿到各个设备数据了 /** 搜索设备回调*/private BluetoothAdapter.LeScanCallback mLeScanCallback = new BluetoothAdapter.LeScanCallback() { @Override public void onLeScan(final BluetoothDevice device, int rssi, byte[] scanRecord) { }}; 123456789101112131415161718192021222324252627282930313233343536这里有几个值得说一下的东西- **1.BluetoothDevice device**![这里写图片描述](http://img.blog.csdn.net/20160712000123059)应该可以看的很清楚, device中包含了设备的基本信息 - **2.rssi信号质量,也有人告诉我是质量**不过我这次并没有使用到- **3.byte[] scanRecord (重头戏)**广播响应包数据一般包括两个部分,我使用的主要是ServiceData域**在这里需要注意的是，这两个部分都存在于广播数据，而且并不是两部分都有，有可能是只有一个部分，所以一定要看情设备的硬件规范，因为这涉及到后面解析广播数据**要知道，我们都是拿byte[]数组中的某些部分对应特定值,一旦对应关系打乱，那么数据解析就没什么正确性可言了 这些广播数据都是依据一定的规则指定 的,所以这时候你需要设备厂商的文档来查看对应的数据,以及其结构PS:需要注意的一点是,这些数据都是byte[],你需要将它们转化(一般常用的做法是,先转化为16进制的字符串,而后再进行读取解析)###4.读取蓝牙设备内部数据这里涉及到两个重要部分service 以及 characteristic一般来说 一个Service eg: FF01-XXXXXXXXXXX-XXXXX 下面可能有很多的characteristicMarjor : FF16 -XXXXXXPower : FF17 - XXX....一堆的characteristic - **如果需要给指定的项目写入一个数据** 条件： 1.此特征在哪个Service下，即该service的UUID 2.该特征的UUID 3.该特征的写入格式，16进制还是其他的东西 //代码片段1//此方法获取对应特征值的对象BluetoothGattCharacteristic的实体 public BluetoothGattCharacteristic getCharacteristic(String service,String charact) { if (mBluetoothGatt == null) return null; if(mBluetoothGatt.getService(UUID.fromString(service))==null){return null ;} return mBluetoothGatt.getService(UUID.fromString(service)).getCharacteristic(UUID.fromString(charact)); } 12 //代码片段2if(!TextUtils.isEmpty(value)){//输入非空 byte[] arrayOfByte= new byte[2];//传入数据规定为2个byte arrayOfByte[0] = ((byte)Integer.parseInt((value).substring(0, 2), 16)); arrayOfByte[1] = ((byte)Integer.parseInt((value).substring(2, 4), 16)); //上面操作，先切，再转为16进制 characteristic.setValue(arrayOfByte); //characteristic实体就是片段1代码获取到的 gattServer.writeCharacteristic(characteristic); //所有的操作都封装在一个service中，gattServer为其实体对象}12 //片段3就是服务中的写入方法 /** * 写入一个数据 * @param characteristic */ public void writeCharacteristic(BluetoothGattCharacteristic characteristic) { mBluetoothGatt.setCharacteristicNotification(characteristic, true); mBluetoothGatt.writeCharacteristic(characteristic); } 12 //代码片段4 这是回调，//在连接时就作为参数传入了 mBluetoothGatt = device.connectGatt(this, false, mGattCallback);private final BluetoothGattCallback mGattCallback = new BluetoothGattCallback() { @Override public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) { if (newState == BluetoothProfile.STATE_CONNECTED) { Log.e(TAG, “连接至 GATT server.”); } else if (newState == BluetoothProfile.STATE_DISCONNECTED) { Log.e(TAG, “断开 GATT server.”); } } @Override public void onServicesDiscovered(BluetoothGatt gatt, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;建立连接成功&quot;); } else { Log.e(TAG, &quot;连接状态异常: &quot; + status); } } @Override public void onCharacteristicWrite(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;写入数据成功&quot;); } } @Override public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;读取数据成功&quot;); } } @Override public void onCharacteristicChanged(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic) { Log.e(TAG, &quot;连接状态发生改变&quot;); }; }``` PS:这里的例子是写入，其实读取的操作与此类似，操作完成后在回调里面判断状态以及读取数据即可]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>蓝牙</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Studio 基本设置]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid-Studio-%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[####1.常用的快捷键 ALT + Enter 自动提示 ALT + Ins get set 构造方法 重写方法以及一些插件如这里的 GsonFormat 以及 Butterknife Ctrl + Alt + F 全局变量 Ctrl +Shift + Enter 加; 以及if 的(){} Ctrl + P 以及 Ctrl + Q 方法参数以及文档 Ctrl +O 继承重写的方法 Ctrl + / Ctrl +Shift + / 注释 Ctrl + Alt + L 格式化 Ctrl + D Ctrl + Y 复制 删除行 Ctrl + Shift + U 大小写 Shift Shift Ctrl + F 全局 当前 搜索 Ctrl + U 到父类 Ctrl + Alt + B 找到子类 Ctrl + H 类结构 Ctrl+Shift + H 方法层次 Ctrl + Alt + H 调用层次 Alt + F7 find use 非常好用的功能 Shift + F6 重命名 logt + Enter Tag loge logd … 打印log ####2.自动生成代码 Ctrl + J 里面相当多的模版代码123456if 判空 ifnfor 循环 for foreach foreachsetVisibility gonefindViewById fbcinstanceof inst 这些比较常用 ####3.自动导入包Settings&gt;Editor&gt;General&gt;Auto import ####4.其他设置已经导出 ps : 在百度云里有]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android Studio</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Studio 导入 Vitamio及横竖屏切换]]></title>
    <url>%2F2017%2F12%2F25%2FAndroid-Studio-%E5%AF%BC%E5%85%A5-Vitamio%E5%8F%8A%E6%A8%AA%E7%AB%96%E5%B1%8F%E5%88%87%E6%8D%A2%2F</url>
    <content type="text"><![CDATA[##建议不要使用Vitamio,各种深坑 https://github.com/Bilibili/ijkplayer看看bilibili的开源播放器 ##Vitamio官方:https://www.vitamio.org/GitHub:https://github.com/yixia/VitamioBundle Vitamio 能够流畅播放720P甚至1080P高清MKV，FLV，MP4，MOV，TS，RMVB等常见格式的视频，支持 MMS, RTSP, RTMP, HLS(m3u8) 等常见的多种视频流媒体协议，包括点播与直播。 ###1.下载Vitamio 地址https://www.vitamio.org/Download/ ###2.解压并导入Android 找到到文件夹VitamioBundle File &gt; New &gt; New Module 导入完成后是这样的 ###3.导入到自己的项目(即不使用Vitamio的libiary,强迫症专属) ####A.在自己的目录下建立io.vov.vitamio 并导入所有的类,以及将jniLibs目录拷贝到main目录下,还有相关的资源文件 ####B.在AndroidManifest.xml文件中写入12345&lt;activity android:name=&quot;io.vov.vitamio.activity.InitActivity&quot; android:configChanges=&quot;orientation|screenSize|smallestScreenSize|keyboard|keyboardHidden|navigation&quot;android:launchMode=&quot;singleTop&quot;android:theme=&quot;@android:style/Theme.NoTitleBar&quot;android:windowSoftInputMode=&quot;stateAlwaysHidden&quot;/&gt; 并加入相应的权限 ####C.在你喜欢的地方初始化Vitamio 开玩笑的,放在activity或者是Application的onCreate中 Vitamio.isInitialized(application.getApplicationContext()); ###3.Vatimio的使用 ####A.界面的搭建 可以看到 整个页面主要分上下两层,主要是为了视屏全屏的时候能方便的隐藏整个下面的布局 ####B.使用在此之前为了方便的使用视屏全屏播放,对MediaController(package io.vov.vitamio.widget)做一个小小的改造:添加一个构造:主要用于把视屏,进度条等放到一个View中,便于全屏展示12345678910111213//这个全屏的操作可把我难坏了,看到这个真的是为原作者的机智点赞 public MediaController(Context context,boolean fromXml,View container) &#123; super(context); initController(context); mFromXml = fromXml; mRoot = makeControllerView(); //这个地方的FrameLayout.LayoutpParams是因为布局文件中要把MediaController的视图作为childView加到一个FrameLayout中去 LayoutParams p = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT); //想怎样布局MediaController就尽情的发挥这个LayoutParams吧 p.gravity = Gravity.BOTTOM; mRoot.setLayoutParams(p); ((FrameLayout)container).addView(mRoot); &#125; 接着你就可以愉快的玩耍了:在oncreate中调用1initVitamioView(); 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950//初始化控件private void initVitamioView() &#123;//VideoViewmVideoView = (VideoView) findViewById(R.id.buffer);//这个就是包裹整个视屏模块的FrameLayoutfl_controller = (FrameLayout) findViewById(R.id.fl_controller);//缓冲时出现的进度条pb = (ProgressBar) findViewById(R.id.probar);//播放进度,并可以拖动调节视屏播放位置downloadRateView = (TextView) findViewById(R.id.download_rate);loadRateView = (TextView) findViewById(R.id.load_rate);//设置视屏setVideoURI可以缓冲并播放//setVideoPath()缓冲完再播放mVideoView.setVideoURI(Uri.parse(TextUtils.isEmpty(path)?defaultPath:path));//这里使用自定义的那个MediaController构造mMediaController= new MediaController(this, true, fl_controller);//这里的监听其实是在MediaController中自己定义的,主要就是全屏的切换按钮mMediaController.setOnControllerClick(new MediaController.OnControllerClick() &#123; @Override public void OnClick(int type) &#123; if (type == 0) &#123; //表示点击切换全屏按钮 if (isPortrait) &#123; //不是全屏,切换为全屏 //代码块1 &#125; else &#123; //是全屏,近来就切为原来的大小 //代码块2 &#125; &#125; &#125; &#125;);//类似绑定 mVideoView.setMediaController(mMediaController);//隐藏控制模块mMediaController.setVisibility(View.GONE);mVideoView.requestFocus();//设置对视屏信息的监听mVideoView.setOnInfoListener(this);//视屏缓冲的监听mVideoView.setOnBufferingUpdateListener(this);//视屏OKmVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() &#123; @Override public void onPrepared(MediaPlayer mediaPlayer) &#123; //设置播放速度 mediaPlayer.setPlaybackSpeed(1.0f); &#125; &#125;); &#125; 补充代码块1123456&gt; RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams(displayheight, displayWidth); fl_controller.setLayoutParams(fl_lp);//设置横屏 setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE); //这样mVideoView会自己充满全屏 mVideoView.setVideoLayout(VideoView.VIDEO_LAYOUT_SCALE, 0); isPortrait = false;&gt; 代码块212345678&gt; RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams( LinearLayout.LayoutParams.MATCH_PARENT, DensityUtils.dip2px(ClassRoomActivity.this,200) ); fl_controller.setLayoutParams(fl_lp); setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); isPortrait = true;&gt; 1234567891011121314151617181920/* * 横竖屏切换的时候回走这个回调 * */@Overridepublic void onConfigurationChanged(Configuration newConfig) &#123; //屏幕切换时，设置全屏 if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) &#123; //隐藏下面的布局和标题 tLBelow.setVisibility(View.GONE); mTitlebar.setVisibility(View.GONE); &#125; if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT) &#123; //显示下面的布局和标题 tLBelow.setVisibility(View.VISIBLE); mTitlebar.setVisibility(View.VISIBLE); &#125; super.onConfigurationChanged(newConfig); &#125; ####C.两个重要的监听(上面已经注册过了)123456//缓冲的监听@Override public void onBufferingUpdate(MediaPlayer mp, int percent) &#123; //显示缓冲进度 loadRateView.setText(percent + &quot;%&quot;); &#125; 1234567891011121314151617181920212223242526272829//视屏信息监听@Override public boolean onInfo(MediaPlayer mp, int what, int extra) &#123; switch (what) &#123; //开始缓冲 case MediaPlayer.MEDIA_INFO_BUFFERING_START: if (mVideoView.isPlaying()) &#123; mVideoView.pause(); pb.setVisibility(View.VISIBLE); downloadRateView.setText(&quot;&quot;); loadRateView.setText(&quot;&quot;); downloadRateView.setVisibility(View.VISIBLE); loadRateView.setVisibility(View.VISIBLE); &#125; break; //停止缓冲,这里自动开始播放 case MediaPlayer.MEDIA_INFO_BUFFERING_END: mVideoView.start(); pb.setVisibility(View.GONE); downloadRateView.setVisibility(View.GONE); loadRateView.setVisibility(View.GONE); break; case MediaPlayer.MEDIA_INFO_DOWNLOAD_RATE_CHANGED: //缓冲的...那个啥 change downloadRateView.setText(&quot;&quot; + extra + &quot;kb/s&quot; + &quot; &quot;); break; &#125; return true; &#125; ###4.就这样 对了,完事记得12345@Override protected void onDestroy() &#123; mVideoView.stopPlayback(); super.onDestroy(); &#125; 基本就是这样了,其他的问题自己解决一下就好了…]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android Studio</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux 学习笔记]]></title>
    <url>%2F2017%2F12%2F24%2FLinux-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[netstat -an 1查看所有网络连接 more命令 123456789101112131415选项-num 指定屏幕的行数（以整数表示）+num 从行号num开始显示-d 让more给用户显示信息[Press space to continue, &apos;q&apos; to quit.]-f 使more计数逻辑行，而不是屏幕行（长行不会断到下一行）-s 把重复的空行压缩成一个空行-u 防止下划线交互基于VIM 字符界面 1.字符界面占用资源少 2.减少了出错,别攻击的可能 一切皆文件 用户 硬件 文件…. 分区 swap 内存的两倍 / 根分区 /boot boot分区 200m即可 (作为启动盘使用,启动需要空间) /home /etc … 安装日志 /root/install.log 记录了安装在系统中的软件包和版本信息 /root/install.log.syslog 安装过程的记录 /root/anaconda-ks.cfg 记录安装过程中的配置信息(用于网络批量安装) linux起始符 123456[root@hadoop ~]#root 用户名hadoop 当前用户的主机名"~" 当前的目录, "~"表示家目录"#" 超级用户的提示符"$" 普通用户的提示符 12 -rw-r–r– 12345678910111213drwxr-xr-x. 2 wzm wzm 4096 6月 21 16:19 Desktop#一共10位 drwxr-xr-x#d第一位 文件类型( -文件 d目录 |软链接文件 c b )#rwx r-x r-x后面的每三位是一组第一个三位 所属者u第二个三位 所属组g第三个三位 其他人o#acf权限r读w写x执行 目录 1234567891011121314151617/ 根目录/etc 配置文件目录/bin 系统命令的目录 (普通用户即可读取)/sbin 系统命令的目录 (超级用户即可读取)/usr/bin 系统命令的目录 (普通用户即可读取)/usr/sbin系统命令的目录 (超级用户即可读取)/home 普通用户的家目录/root 超级用户的家目录/usr 系统软件资源目录/boot 启动目录/var 系统相关文档/sys 直接写入内存/proc 直接写入内存/dev 设备文件目录/lib 系统库 保存目录/mnt 系统挂载目录/media 挂载目录 linux 常用命令 control + L 清屏 文件命令 基本命令格式 12345678910命令 [选项] [参数]#lsls -a 显示所有文件 -l 显示详细信息,目录下所有内容 -d 查看目录属性,目录本身 -h 人性化显示文件大小 -i 显示inode 文件的id号ll ll -l# ​ 目录文件处理 12345678910111213141516171819202122232425262728#mkdir 创建目录mkdir -p 递归创建,创建多级目录 #cd 切换目录cd ~ 当前用户的家目录 - 进入上次进入的目录 .. 进入上级目录 . 进入当前目录 #pwdpwd 显示当前目录全路径#rm -rf [文件或目录]rm -f 强制删除 -r 删除目录 #cpcp -r 复制目录 -p 连带文件的属性一起复制 -d 如果文件为链接文件,则复制链接属性 -a 相当于-pdr#mvmv [源地址] [目标地址] ​ 软链接命令(源文件一定写巨绝对路径) 12345678910#ln [源] [目标]ln不能跨分区,不能是一个目录相当于一个文件 文件id号相同 -s 软链接 类似windows里面的快捷方式 有自己的id号 其实是去查看自己的存储点, 存储点里面是源文件的id号, 然后又用源文件id号去找源文件的存储点 ​ 搜索命令 1234locate 文件搜索命令whereis 与 whichfind 文件搜索命令grep 字符串搜索命令 locate 123456789#locatelocate [文件名]在后台数据库中按文件名搜索位置在:/var/lib/mlocate#updatedbupdatedb 更新数据库 whereis 1234#whereiswhereis [命令名] -b 之查找可执行文件 -m 只查找帮助文件 which 1234查看#whichwhich [文件名]搜索命令所在目录路径已经别名 find 1234567891011121314151617181920212223242526272829303132333435363738394041#find#避大范围搜索,会非常消耗系统资源#如果不用通配符,则会搜索与文件名完全一致的文件find [搜素范围] [搜索条件]find [搜素范围] -name [名字] -iname [名字] 不区分大小写 -user [所有者] 按所有者搜索 -nouser 查找没有所有者的文件 -mtime [] 修改文件内容的时间 -atime [] 文件访问时间 -ctime [] 改变文件属性的时间 [-10 10 +10 10天内 10天当天 +10天前] -size [大小] 当前目录下查找大小是 25k的文件 [-25k 25k +25k] [-2M 2M +2M] -inum [id号] -a and 逻辑与,同时满足两个条件 eg find /etc -size +25k -a -size -50k -o or 逻辑或,两个条件满足一个条件即可 -exec [一个命令] &#123;&#125; \; 搜索出来的结果再执行一次命令 eg find /etc -size +25k -a -size -50k -exec ls -lh &#123;&#125; \;#通配符* 匹配任何内容? 匹配任意一个字符[] 匹配任意一个中口号内的字符 eg: abc abd find /home -name ab[cd] ​ grep 1234#grepgrep "size" system.loggrep是包含匹配 在 system.log 中查找"size" ​ 帮助命令 123456789101112131415man [命令]whatis [命令] man -f [命令] 命令的帮助级别man -k [命令] 模糊匹配 apropos [命令] 模糊匹配[命令] --help内核的命令查看帮助help [命令] ​ 压缩与解压缩 1常用压缩格式 .zip .gz .bz2 .tar.gz .tar.bz2 zip 123456zip [压缩文件名字] [源文件]zip -r [压缩文件名字] [源目录]#解压缩unzip [zip文件] gz 123456789101112131415gzip [源文件] #压缩为.gz格式的压缩文件,源文件会消失gzip -c [源文件] &gt; 压缩文件#压缩为.gz格式 ,源文件保留gzip -r [源目录] #压缩目录下所有的子文件,但是不能压缩目录#解压缩gzip -d [压缩文件]gunzip [压缩文件]gzp -d -r [目录] 解压目录下所有的文件 tar 123456789#tartar -cvf [打包文件名] [源文件] -c 打包 -v 显示过程 -f 指定打包后的文件名 eg tar -cvf jp.tar jp#解压缩tar -xvf [压缩文件] - .tar.gz 1234tar -zcvf [压缩文件名] [源文件]#解压缩tar -zxvf [压缩包名.tar.gz] 关机和重启 123456shutdown [选项] 时间 -c 取消前一个关机命令 -h 关机 -r 重启 logout 退出登录 其他的命令 123w 显示所有的登录用户last 所有登录信息lastlog 所有用户登录信息 其他快捷键 1234567control + c 强制终止当前命令control + l 清屏control + a 光标移动到行首control + e 光标移动到行尾control + u 从光标位置删除到行首control + z 把命令放入到后台control + r 在历史记录中搜索 输出重定向 1234567891011121314151617#标准的输出重定向命令 &gt; 文件 覆盖的方式写入命令 &gt;&gt; 文件 追加的方式写入#错误输出重定向错误命令 2&gt; 文件 覆盖的方式写入错误提示错误命令 2&gt;&gt; 文件 追加的方式写入错误提示#正确和错误的同时输出命令 &gt;&gt; 文件 2&gt;&amp;1命令 &amp;&gt;&gt; 文件#正确错误分开输出命令 &gt;&gt; 文件 2&gt;&gt; 文件 -输入重定向 123456789101112wc [选项] [文件名] -c 统计字节数 -w 统计单词数 -l 统计行数 wc在终端输入文字 control + D 统计结果wc [文件名] 文件内容输入到终端 管道符 多命令执行(前一条命令的结果不会传入) 123456789[命令1] ; [命令2] 顺序执行[命令1] &amp;&amp; [命令2] 命令1执行正确 命令2执行 命令1执行错误 命令2不会执行[命令1] || [命令2] 当命令1执行不正确 命令2执行 命令1执行正确 命令2就不会执行 - 管道符(前一条命令的结果传入下一个命令) 123 # |[命令1] | [命令2] 命令2会去操作命令1执行的结果 通配符 1234567891011121314? 任意一个字符* 任意内容[] 匹配括号中的某一个字符[-] 匹配括号中的任意一个字符 - 代表一个范围 [a-z] [1-3][^] 表示匹配不是括号中的字符 比如[^0-9] 指匹配不是数字的字符&apos;&apos; 单引号 在单引号中所有字符都没有特殊含义&quot;&quot; 双引号 除了&quot;$&quot; 和 &quot;`&quot; &quot;\&quot; 其他字符都没有特殊意义`` 反引号 是系统命令内容$() 用来引用系统命令# shell中表示注释$ 调用变量的值\ 转义符]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Server</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Facebook/Stetho——Android开发调试神器]]></title>
    <url>%2F2017%2F12%2F24%2FFacebook-Stetho%E2%80%94%E2%80%94Android%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E7%A5%9E%E5%99%A8%2F</url>
    <content type="text"><![CDATA[####一、简介 Stetho是一个Android应用调试工具。集成后，开发人员可以通过Chrome的开发工具查看App相关的信息和调试；可视化操作，不需要自己使用adb也不需要root权限。 ####二、APP集成 1.下载最新的jar，或者通过Gradle引入stetho的libraay 1compile &apos;com.facebook.stetho:stetho:1.3.1&apos; 2.只需要在 Application的 onCreate 方法中调用 123456public class MyApplication extends Application &#123; public void onCreate() &#123; super.onCreate(); Stetho.initializeWithDefaults(this); &#125; &#125; 3.如果还想查看网络请求的话，需要引入另外的Library 1compile &apos;com.facebook.stetho:stetho-okhttp3:1.3.1&apos; 4.使用okhttp 还需要添加 StethoInterceptor 123OkHttpClient client = new OkHttpClient.Builder() .addNetworkInterceptor(new StethoInterceptor()) .build(); ####三、使用配置完成之后，在Chrome地址栏输入chrome://inspect chrome://inspect/#devices chrome会检测到我们的app，点击 inspect 进入查看页面]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[String.format的参数表]]></title>
    <url>%2F2017%2F12%2F23%2FString-format%E7%9A%84%E5%8F%82%E6%95%B0%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[####String.format() 1234567891011121314%s 字符串类型 &quot;mingrisoft&quot;%c 字符类型 &apos;m&apos;%b 布尔类型 true%d 整数类型（十进制） 99%x 整数类型（十六进制） FF%o 整数类型（八进制） 77%f 浮点类型 99.99%a 十六进制浮点类型 FF.35AE%e 指数类型 9.38e+5%g 通用浮点类型（f和e类型中较短的）%h 散列码 %% 百分比类型 ％%n 换行符%tx 日期与时间类型（x代表不同的日期与时间转换符]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[透明度对照表]]></title>
    <url>%2F2017%2F12%2F23%2F%E9%80%8F%E6%98%8E%E5%BA%A6%E5%AF%B9%E7%85%A7%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[####透明度对照表 1234567891011121314151617181920212223242526272829303132333435363738394041100% — FF95% — F290% — E685% — D980% — CC75% — BF70% — B365% — A660% — 9955% — 8C50% — 8045% — 7340% — 6635% — 5930% — 4D25% — 4020% — 3315% — 2610% — 1A5% — 0D0% — 00]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
</search>
